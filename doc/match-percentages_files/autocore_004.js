
			// File : /okcontent/js/browserinfo.js
			AUTOCORE_SELF_CHECK = "/okcontent/js/browserinfo.js";
			
var jsVer=-1;function getBrowser(obj){var b=new Array("unknown","unknown","unknown","unknown");(isEmpty(obj)?brs=navigator.userAgent.toLowerCase():brs=obj);if(brs.search(/omniweb[\/\s]v?(\d+([\.-]\d)*)/)!=-1){b[0]="omniweb";b[1]=brs.match(/omniweb[\/\s]v?(\d+([\.-]\d)*)/)[1];(b[1]>4.5?b[2]="khtml":b[2]="omniweb");(brs.search(/omniweb[\/\s]((\d+([\.-]\d)*)-)?v(\d+([\.-]\d)*)/)==-1?b[3]=brs.match(/omniweb[\/\s](\d+([\.-]\d)*)/)[1]:b[3]=brs.match(/omniweb[\/\s]((\d+([\.-]\d)*)-)?v(\d+([\.-]\d)*)/)[4]);return b;}else if(brs.search(/opera[\/\s](\d+(\.?\d)*)/)!=-1){b[0]="opera";b[1]=brs.match(/opera[\/\s](\d+(\.?\d)*)/)[1];b[2]="opera";b[3]=b[1];return b;}else if(brs.search(/crazy\s?browser\s(\d+(\.?\d)*)/)!=-1){b[0]="crazy";b[1]=brs.match(/crazy\s?browser\s(\d+(\.?\d)*)/)[1];b[2]="msie";b[3]=getMSIEVersion();return b;}else if(brs.search(/myie2/)!=-1){b[0]="myie2";b[2]="msie";b[3]=brs.match(/msie\s(\d+(\.?\d)*)/)[1];return b;}else if(brs.search(/netcaptor/)!=-1){b[0]="netcaptor";b[1]=brs.match(/netcaptor\s(\d+(\.?\d)*)/)[1];b[2]="msie";b[3]=getMSIEVersion();return b;}else if(brs.search(/avant\sbrowser/)!=-1){b[0]="avantbrowser";b[2]="msie";b[3]=getMSIEVersion();return b;}else if(brs.search(/msn\s(\d+(\.?\d)*)/)!=-1){b[0]="msn";b[1]=brs.match(/msn\s(\d+(\.?\d)*)/)[1];b[2]="msie";b[3]=getMSIEVersion();return b;}else if(brs.search(/msie\s(\d+(\.?\d)*)/)!=-1){b[0]="msie";b[1]=getMSIEVersion();b[2]="msie";b[3]=b[1];return b;}else if(brs.search(/powermarks\/(\d+(\.?\d)*)/)!=-1){b[0]="powermarks";b[1]=brs.match(/powermarks\/(\d+(\.?\d)*)/)[1];b[2]="msie";try{b[3]=getMSIEVersion();}catch(e){}
return b;}else if(brs.search(/konqueror[\/\s](\d+([\.-]\d)*)/)!=-1){b[0]="konqueror";b[1]=brs.match(/konqueror[\/\s](\d+([\.-]\d)*)/)[1];b[2]="khtml";return b;}else if(brs.search(/safari\/(\d)*/)!=-1){b[0]="safari";b[1]=brs.match(/safari\/(\d+(\.?\d*)*)/)[1];b[2]="khtml";b[3]=brs.match(/applewebkit\/(\d+(\.?\d*)*)/)[1];return b;}else if(brs.search(/zyborg/)!=-1){b[0]="zyborg";b[1]=brs.match(/zyborg\/(\d+(\.?\d)*)/)[1];b[2]="robot";b[3]="-1"
return b;}else if(brs.search(/netscape6[\/\s](\d+([\.-]\d)*)/)!=-1){b[0]="netscape";b[1]=brs.match(/netscape6[\/\s](\d+([\.-]\d)*)/)[1];b[2]="gecko";b[3]=getGeckoVersion();return b;}else if(brs.search(/netscape\/(7\.\d*)/)!=-1){b[0]="netscape";b[1]=brs.match(/netscape\/(7\.\d*)/)[1];b[2]="gecko";b[3]=getGeckoVersion();return b;}else if(brs.search(/galeon[\/\s](\d+([\.-]\d)*)/)!=-1){b[0]="galeon";b[1]=brs.match(/galeon[\/\s](\d+([\.-]\d)*)/)[1];b[2]="gecko";b[3]=getGeckoVersion();return b;}else if(brs.search(/nautilus[\/\s](\d+([\.-]\d)*)/)!=-1){b[0]="nautilus";b[1]=brs.match(/nautilus[\/\s](\d+([\.-]\d)*)/)[1];b[2]="gecko";b[3]=getGeckoVersion();return b;}else if(brs.search(/firefox[\/\s](\d+([\.-]\d)*)/)!=-1){b[0]="firefox";b[1]=brs.match(/firefox[\/\s](\d+([\.-]\d)*)/)[1];b[2]="gecko";b[3]=getGeckoVersion();return b;}else if(brs.search(/k-meleon[\/\s](\d+([\.-]\d)*)/)!=-1){b[0]="kmeleon";b[1]=brs.match(/k-meleon[\/\s](\d+([\.-]\d)*)/)[1];b[2]="gecko";b[3]=getGeckoVersion();return b;}else if(brs.search(/playstation\s3/)!=-1){b[0]="netfront";b[1]="2.81";b[2]="playstation3"
b[3]=brs.match(/playstation\s3;\s(\d+\.\d+)/)[1];return b;}else if(brs.search(/firebird[\/\s](\d+([\.-]\d)*)/)!=-1){b[0]="firebird";b[1]=brs.match(/firebird[\/\s](\d+([\.-]\d)*)/)[1];b[2]="gecko";b[3]=getGeckoVersion();return b;}else if(brs.search(/phoenix[\/\s](\d+([\.-]\d)*)/)!=-1){b[0]="phoenix";b[1]=brs.match(/phoenix[\/\s](\d+([\.-]\d)*)/)[1];b[2]="gecko";b[3]=getGeckoVersion();return b;}else if(brs.search(/camino[\/\s](\d+([\.-]\d)*)/)!=-1){b[0]="camino";b[1]=brs.match(/camino[\/\s](\d+([\.-]\d)*)/)[1];b[2]="gecko";b[3]=getGeckoVersion();return b;}else if(brs.search(/epiphany[\/\s](\d+([\.-]\d)*)/)!=-1){b[0]="epiphany";b[1]=brs.match(/epiphany[\/\s](\d+([\.-]\d)*)/)[1];b[2]="gecko";b[3]=getGeckoVersion();return b;}else if(brs.search(/chimera[\/\s](\d+([\.-]\d)*)/)!=-1){b[0]="chimera";b[1]=brs.match(/chimera[\/\s](\d+([\.-]\d)*)/)[1];b[2]="gecko";b[3]=getGeckoVersion();return b;}else if(brs.search(/icab[\s\/]?(\d+(\.?\d)*)/)!=-1){b[0]="icab";b[1]=brs.match(/icab[\s\/]?(\d+(\.?\d)*)/)[1];b[2]="icab";b[3]=b[1];return b;}else if(brs.search(/netfront\/(\d+([\._]\d)*)/)!=-1){b[0]="netfront";b[1]=brs.match(/netfront\/(\d+([\._]\d)*)/)[1];b[2]="netfront";b[3]=b[1];return b;}else if(brs.search(/netscape4\/(\d+([\.-]\d)*)/)!=-1){b[0]="netscape";b[1]=brs.match(/netscape4\/(\d+([\.-]\d)*)/)[1];b[2]="mozold";b[3]=b[1];return b;}else if((brs.search(/mozilla\/(4.\d*)/)!=-1)&&(brs.search(/msie\s(\d+(\.?\d)*)/)==-1)){b[0]="netscape";b[1]=brs.match(/mozilla\/(4.\d*)/)[1];b[2]="mozold";b[3]=b[1];return b;}else if((brs.search(/mozilla\/5.0/)!=-1)&&(brs.search(/gecko\//)!=-1)){b[0]="mozsea";b[1]=brs.match(/rv\x3a(\d+(\.?\d)*)/)[1];b[2]="gecko";b[3]=getGeckoVersion();return b;}else if(brs.search(/elinks/)!=-1){b[0]="elinks";(brs.search(/elinks\/(\d+(\.?\d)*)/)==-1?b[1]=brs.match(/elinks\s\x28(\d+(\.?\d)*)/)[1]:b[1]=brs.match(/elinks\/(\d+(\.?\d)*)/)[1]);b[2]="elinks";b[3]=b[1];return b;}else if(brs.search(/w3m\/(\d+(\.?\d)*)/)!=-1){b[0]="w3m"
b[1]=brs.match(/(^w3m|\sw3m)\/(\d+(\.?\d)*)/)[2];b[2]="w3m";b[3]=b[1];return b;}else if(brs.search(/links/)!=-1){b[0]="links";(brs.search(/links\/(\d+(\.?\d)*)/)==-1?b[1]=brs.match(/links\s\x28(\d+(\.?\d)*)/)[1]:b[1]=brs.match(/links\/(\d+(\.?\d)*)/)[1]);b[2]="links";b[3]=b[1];return b;}else if(brs.search(/java[\/\s]?(\d+([\._]\d)*)/)!=-1){b[0]="java";b[1]=brs.match(/java[\/\s]?(\d+([\._]\d)*)/)[1];b[2]="java";b[3]=b[1];return b;}else if(brs.search(/lynx/)!=-1){b[0]="lynx";b[1]=brs.match(/lynx\/(\d+(\.?\d)*)/)[1];b[2]="libwww-fm";b[3]=brs.match(/libwww-fm\/(\d+(\.?\d)*)/)[1];return b;}else if(brs.search(/dillo/)!=-1){b[0]="dillo";b[1]=brs.match(/dillo\s*\/*(\d+(\.?\d)*)/)[1];b[2]="dillo";b[3]=b[1];return b;}else if(brs.search(/wget/)!=-1){b[0]="wget";b[1]=brs.match(/wget\/(\d+(\.?\d)*)/)[1];b[2]="robot";b[3]="-1"
return b;}else if(brs.search(/googlebot\-image/)!=-1){b[0]="googlebotimg";b[1]=brs.match(/googlebot\-image\/(\d+(\.?\d)*)/)[1];b[2]="robot";b[3]="-1"
return b;}else if(brs.search(/googlebot/)!=-1){b[0]="googlebot";b[1]=brs.match(/googlebot\/(\d+(\.?\d)*)/)[1];b[2]="robot";b[3]="-1"
return b;}else if(brs.search(/msnbot/)!=-1){b[0]="msnbot";b[1]=brs.match(/msnbot\/(\d+(\.?\d)*)/)[1];b[2]="robot";b[3]="-1"
return b;}else if(brs.search(/turnitinbot/)!=-1){b[0]="turnitinbot";b[1]=brs.match(/turnitinbot\/(\d+(\.?\d)*)/)[1];b[2]="robot";b[3]="-1"
return b;}else{b[0]="unknown";return b;}}
function getMajorVersion(v){return(isEmpty(v)?-1:(hasDot(v)?v:v.match(/(\d*)(\.\d*)*/)[1]))}
function getMinorVersion(v){return(!isEmpty(v)?(!hasDot(v)?v.match(/\.(\d*([-\.]\d*)*)/)[1]:0):-1)}
function getOS(obj){var os=new Array("unknown","unknown");(isEmpty(obj)?brs=navigator.userAgent.toLowerCase():brs=obj);if(brs.search(/windows\sce/)!=-1){os[0]="wince";try{os[1]=brs.match(/windows\sce\/(\d+(\.?\d)*)/)[1];}catch(e){}
return os;}else if((brs.search(/windows/)!=-1)||((brs.search(/win9\d{1}/)!=-1))){os[0]="win";if(brs.search(/nt\s5\.1/)!=-1){os[1]="xp";}else if(brs.search(/nt\s5\.0/)!=-1){os[1]="2000";}else if((brs.search(/win98/)!=-1)||(brs.search(/windows\s98/)!=-1)){os[1]="98";}else if(brs.search(/windows\sme/)!=-1){os[1]="me";}else if(brs.search(/nt\s5\.2/)!=-1){os[1]="win2k3";}else if((brs.search(/windows\s95/)!=-1)||(brs.search(/win95/)!=-1)){os[1]="95";}else if((brs.search(/nt\s4\.0/)!=-1)||(brs.search(/nt4\.0/))!=-1){os[1]="nt4";}
return os;}else if(brs.search(/linux/)!=-1){os[0]="linux";try{os[1]=brs.match(/linux\s?(\d+(\.?\d)*)/)[1];}catch(e){}
return os;}else if(brs.search(/mac\sos\sx/)!=-1){os[0]="macosx";return os;}else if(brs.search(/freebsd/)!=-1){os[0]="freebsd";try{os[1]=brs.match(/freebsd\s(\d(\.\d)*)*/)[1];}catch(e){}
return os;}else if(brs.search(/sunos/)!=-1){os[0]="sunos";try{os[1]=brs.match(/sunos\s(\d(\.\d)*)*/)[1];}catch(e){}
return os;}else if(brs.search(/irix/)!=-1){os[0]="irix";try{os[1]=brs.match(/irix\s(\d(\.\d)*)*/)[1];}catch(e){}
return os;}else if(brs.search(/openbsd/)!=-1){os[0]="openbsd";try{os[1]=brs.match(/openbsd\s(\d(\.\d)*)*/)[1];}catch(e){}
return os;}else if((brs.search(/macintosh/)!=-1)||(brs.search(/mac\x5fpowerpc/)!=-1)){os[0]="macclassic";return os;}else if(brs.search(/os\/2/)!=-1){os[0]="os2";try{os[1]=brs.match(/warp\s((\d(\.\d)*)*)/)[1];}catch(e){}
return os;}else if(brs.search(/openvms/)!=-1){os[0]="openvms";try{os[1]=brs.match(/openvms\sv((\d(\.\d)*)*)/)[1];}catch(e){}
return os;}else if((brs.search(/amigaos/)!=-1)||(brs.search(/amiga/)!=-1)){os[0]="amigaos";try{os[1]=brs.match(/amigaos\s?(\d(\.\d)*)*/)[1];}catch(e){}
return os;}else if(brs.search(/hurd/)!=-1){os[0]="hurd";return os;}else if(brs.search(/hp\-ux/)!=-1){os[0]="hpux";try{os[1]=brs.match(/hp\-ux\sb\.[\/\s]?(\d+([\._]\d)*)/)[1];}catch(e){}
return os;}else if((brs.search(/unix/)!=-1)||(brs.search(/x11/)!=-1)){os[0]="unix";return os;}else if(brs.search(/cygwin/)!=-1){os[0]="cygwin";return os;}else if(brs.search(/java[\/\s]?(\d+([\._]\d)*)/)!=-1){os[0]="java";try{os[1]=brs.match(/java[\/\s]?(\d+([\._]\d)*)/)[1];}catch(e){}
return os;}else if(brs.search(/palmos/)!=-1){os[0]="palmos";return os;}else if(brs.search(/symbian\s?os\/(\d+([\._]\d)*)/)!=-1){os[0]="symbian";try{os[1]=brs.match(/symbian\s?os\/(\d+([\._]\d)*)/)[1];}catch(e){}
return os;}else{os[0]="unknown";return os;}}
function getGeckoVersion(){return brs.match(/gecko\/([0-9]+)/)[1];}
function getMSIEVersion(){return brs.match(/msie\s(\d+(\.?\d)*)/)[1];}
function getFullUAString(obj){(isEmpty(obj)?brs=navigator.userAgent.toLowerCase():brs=obj);return brs;}
function hasFlashPlugin(obj){(isEmpty(obj)?brs=navigator.userAgent.toLowerCase():brs=obj);var f=new Array("0","0");var brwEng=getBrowser(obj)[2];var opSys=getOS(obj)[0];if((brwEng=="gecko")||(brwEng=="opera")||(brwEng=="khtml")||(brwEng=="mozold")||(opSys=="macosx")||(opSys=="macclassic")){if(navigator.plugins&&navigator.plugins.length){x=navigator.plugins["Shockwave Flash"];if(x){f[0]=2;if(x.description){y=x.description;f[1]=y.charAt(y.indexOf('.')-1);}}else{f[0]=1;}
if(navigator.plugins["Shockwave Flash 2.0"]){f[0]=2;f[0]=2;}}else if(navigator.mimeTypes&&navigator.mimeTypes.length){x=navigator.mimeTypes['application/x-shockwave-flash'];if(x&&x.enabledPlugin){f[0]=2;}else{f[0]=1;}}
return f;}else if(brwEng=="msie"){for(var i=15;i>0;i--){try{var flash=new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+i);f[1]=i;break;}catch(e){}}
if(f[1]>0){f[0]=2}else{f[0]=1}
return f;}else{f[0]=0;f[1]=0;return f;}}
function popupsAllowed(){var allowed=false;var w=window.open("about:blank","","directories=no,height=1,width=1,menubar=no,resizable=no,scrollbars=no,status=no,titlebar=no,left=0,top=0,location=no");if(w){allowed=true;w.close();}
return allowed;}
function _jsVersion(){document.write('<script language="JavaScript1.0">');document.write('var jsVer=1.0;');document.write('</script>');document.write('<script language="JavaScript1.1">');document.write('var jsVer=1.1;');document.write('</script>');document.write('<script language="JavaScript1.2">');document.write('var jsVer=1.2;');document.write('</script>');document.write('<script language="JavaScript1.3">');document.write('var jsVer=1.3;');document.write('</script>');document.write('<script language="JavaScript1.4">');document.write('var jsVer=1.4;');document.write('</script>');document.write('<script language="JavaScript1.5">');document.write('var jsVer=1.5;');document.write('</script>');document.write('<script language="JavaScript1.6">');document.write('var jsVer=1.6;');document.write('</script>');document.write('<script language="JavaScript1.7">');document.write('var jsVer=1.7;');document.write('</script>');document.write('<script language="JavaScript1.8">');document.write('var jsVer=1.8;');document.write('</script>');document.write('<script language="JavaScript2.0">');document.write('var jsVer=2.0;');document.write('</script>');}
function jsVersion(){_jsVersion();return jsVer;}
function isEmpty(input){return(input==null||input=="")}
function hasDot(input){return(input.search(/\./)==-1)}
			AUTOCORE_SELF_CHECK = null;
		
			// File : /okcontent/js/scriptaculous-1.8.1-for-autocore/builder.js
			AUTOCORE_SELF_CHECK = "/okcontent/js/scriptaculous-1.8.1-for-autocore/builder.js";
			
var Builder={NODEMAP:{AREA:'map',CAPTION:'table',COL:'table',COLGROUP:'table',LEGEND:'fieldset',OPTGROUP:'select',OPTION:'select',PARAM:'object',TBODY:'table',TD:'table',TFOOT:'table',TH:'table',THEAD:'table',TR:'table'},node:function(elementName){elementName=elementName.toUpperCase();var parentTag=this.NODEMAP[elementName]||'div';var parentElement=document.createElement(parentTag);try{parentElement.innerHTML="<"+elementName+"></"+elementName+">";}catch(e){}
var element=parentElement.firstChild||null;if(element&&(element.tagName.toUpperCase()!=elementName))
element=element.getElementsByTagName(elementName)[0];if(!element)element=document.createElement(elementName);if(!element)return;if(arguments[1])
if(this._isStringOrNumber(arguments[1])||(arguments[1]instanceof Array)||arguments[1].tagName){this._children(element,arguments[1]);}else{var attrs=this._attributes(arguments[1]);if(attrs.length){try{parentElement.innerHTML="<"+elementName+" "+
attrs+"></"+elementName+">";}catch(e){}
element=parentElement.firstChild||null;if(!element){element=document.createElement(elementName);for(attr in arguments[1])
element[attr=='class'?'className':attr]=arguments[1][attr];}
if(element.tagName.toUpperCase()!=elementName)
element=parentElement.getElementsByTagName(elementName)[0];}}
if(arguments[2])
this._children(element,arguments[2]);return element;},_text:function(text){return document.createTextNode(text);},ATTR_MAP:{'className':'class','htmlFor':'for'},_attributes:function(attributes){var attrs=[];for(attribute in attributes)
attrs.push((attribute in this.ATTR_MAP?this.ATTR_MAP[attribute]:attribute)+'="'+attributes[attribute].toString().escapeHTML().gsub(/"/,'&quot;')+'"');return attrs.join(" ");},_children:function(element,children){if(children.tagName){element.appendChild(children);return;}
if(typeof children=='object'){children.flatten().each(function(e){if(typeof e=='object')
element.appendChild(e)
else
if(Builder._isStringOrNumber(e))
element.appendChild(Builder._text(e));});}else
if(Builder._isStringOrNumber(children))
element.appendChild(Builder._text(children));},_isStringOrNumber:function(param){return(typeof param=='string'||typeof param=='number');},build:function(html){var element=this.node('div');$(element).update(html.strip());return element.down();},dump:function(scope){if(typeof scope!='object'&&typeof scope!='function')scope=window;var tags=("A ABBR ACRONYM ADDRESS APPLET AREA B BASE BASEFONT BDO BIG BLOCKQUOTE BODY "+"BR BUTTON CAPTION CENTER CITE CODE COL COLGROUP DD DEL DFN DIR DIV DL DT EM FIELDSET "+"FONT FORM FRAME FRAMESET H1 H2 H3 H4 H5 H6 HEAD HR HTML I IFRAME IMG INPUT INS ISINDEX "+"KBD LABEL LEGEND LI LINK MAP MENU META NOFRAMES NOSCRIPT OBJECT OL OPTGROUP OPTION P "+"PARAM PRE Q S SAMP SCRIPT SELECT SMALL SPAN STRIKE STRONG STYLE SUB SUP TABLE TBODY TD "+"TEXTAREA TFOOT TH THEAD TITLE TR TT U UL VAR").split(/\s+/);tags.each(function(tag){scope[tag]=function(){return Builder.node.apply(Builder,[tag].concat($A(arguments)));}});}}
			AUTOCORE_SELF_CHECK = null;
		
			// File : /okcontent/js/scriptaculous-1.8.1-for-autocore/dragdrop.js
			AUTOCORE_SELF_CHECK = "/okcontent/js/scriptaculous-1.8.1-for-autocore/dragdrop.js";
			
var Droppables={drops:[],remove:function(element){this.drops=this.drops.reject(function(d){return d.element==$(element)});},add:function(element){element=$(element);var options=Object.extend({greedy:true,hoverclass:null,tree:false},arguments[1]||{});if(options.containment){options._containers=[];var containment=options.containment;if(Object.isArray(containment)){containment.each(function(c){options._containers.push($(c))});}else{options._containers.push($(containment));}}
if(options.accept)options.accept=[options.accept].flatten();Element.makePositioned(element);options.element=element;this.drops.push(options);},findDeepestChild:function(drops){deepest=drops[0];for(i=1;i<drops.length;++i)
if(Element.isParent(drops[i].element,deepest.element))
deepest=drops[i];return deepest;},isContained:function(element,drop){var containmentNode;if(drop.tree){containmentNode=element.treeNode;}else{containmentNode=element.parentNode;}
return drop._containers.detect(function(c){return containmentNode==c});},isAffected:function(point,element,drop){return((drop.element!=element)&&((!drop._containers)||this.isContained(element,drop))&&((!drop.accept)||(Element.classNames(element).detect(function(v){return drop.accept.include(v)})))&&Position.within(drop.element,point[0],point[1]));},deactivate:function(drop){if(drop.hoverclass)
Element.removeClassName(drop.element,drop.hoverclass);this.last_active=null;},activate:function(drop){if(drop.hoverclass)
Element.addClassName(drop.element,drop.hoverclass);this.last_active=drop;},show:function(point,element){if(!this.drops.length)return;var drop,affected=[];this.drops.each(function(drop){if(Droppables.isAffected(point,element,drop))
affected.push(drop);});if(affected.length>0)
drop=Droppables.findDeepestChild(affected);if(this.last_active&&this.last_active!=drop)this.deactivate(this.last_active);if(drop){Position.within(drop.element,point[0],point[1]);if(drop.onHover)
drop.onHover(element,drop.element,Position.overlap(drop.overlap,drop.element));if(drop!=this.last_active)Droppables.activate(drop);}},fire:function(event,element){if(!this.last_active)return;Position.prepare();if(this.isAffected([Event.pointerX(event),Event.pointerY(event)],element,this.last_active))
if(this.last_active.onDrop){this.last_active.onDrop(element,this.last_active.element,event);return true;}},reset:function(){if(this.last_active)
this.deactivate(this.last_active);}}
var Draggables={drags:[],observers:[],register:function(draggable){if(this.drags.length==0){this.eventMouseUp=this.endDrag.bindAsEventListener(this);this.eventMouseMove=this.updateDrag.bindAsEventListener(this);this.eventKeypress=this.keyPress.bindAsEventListener(this);Event.observe(document,"mouseup",this.eventMouseUp);Event.observe(document,"mousemove",this.eventMouseMove);Event.observe(document,"keypress",this.eventKeypress);}
this.drags.push(draggable);},unregister:function(draggable){this.drags=this.drags.reject(function(d){return d==draggable});if(this.drags.length==0){Event.stopObserving(document,"mouseup",this.eventMouseUp);Event.stopObserving(document,"mousemove",this.eventMouseMove);Event.stopObserving(document,"keypress",this.eventKeypress);}},activate:function(draggable){if(draggable.options.delay){this._timeout=setTimeout(function(){Draggables._timeout=null;window.focus();Draggables.activeDraggable=draggable;}.bind(this),draggable.options.delay);}else{window.focus();this.activeDraggable=draggable;}},deactivate:function(){this.activeDraggable=null;},updateDrag:function(event){if(!this.activeDraggable)return;var pointer=[Event.pointerX(event),Event.pointerY(event)];if(this._lastPointer&&(this._lastPointer.inspect()==pointer.inspect()))return;this._lastPointer=pointer;this.activeDraggable.updateDrag(event,pointer);},endDrag:function(event){if(this._timeout){clearTimeout(this._timeout);this._timeout=null;}
if(!this.activeDraggable)return;this._lastPointer=null;this.activeDraggable.endDrag(event);this.activeDraggable=null;},keyPress:function(event){if(this.activeDraggable)
this.activeDraggable.keyPress(event);},addObserver:function(observer){this.observers.push(observer);this._cacheObserverCallbacks();},removeObserver:function(element){this.observers=this.observers.reject(function(o){return o.element==element});this._cacheObserverCallbacks();},notify:function(eventName,draggable,event){if(this[eventName+'Count']>0)
this.observers.each(function(o){if(o[eventName])o[eventName](eventName,draggable,event);});if(draggable.options[eventName])draggable.options[eventName](draggable,event);},_cacheObserverCallbacks:function(){['onStart','onEnd','onDrag'].each(function(eventName){Draggables[eventName+'Count']=Draggables.observers.select(function(o){return o[eventName];}).length;});}}
var Draggable=Class.create({initialize:function(element){var defaults={handle:false,reverteffect:function(element,top_offset,left_offset){var dur=Math.sqrt(Math.abs(top_offset^2)+Math.abs(left_offset^2))*0.02;new Effect.Move(element,{x:-left_offset,y:-top_offset,duration:dur,queue:{scope:'_draggable',position:'end'}});},endeffect:function(element){var toOpacity=Object.isNumber(element._opacity)?element._opacity:1.0;new Effect.Opacity(element,{duration:0.2,from:0.7,to:toOpacity,queue:{scope:'_draggable',position:'end'},afterFinish:function(){Draggable._dragging[element]=false}});},zindex:1000,revert:false,quiet:false,scroll:false,scrollSensitivity:20,scrollSpeed:15,snap:false,delay:0};if(!arguments[1]||Object.isUndefined(arguments[1].endeffect))
Object.extend(defaults,{starteffect:function(element){element._opacity=Element.getOpacity(element);Draggable._dragging[element]=true;new Effect.Opacity(element,{duration:0.2,from:element._opacity,to:0.7});}});var options=Object.extend(defaults,arguments[1]||{});this.element=$(element);if(options.handle&&Object.isString(options.handle))
this.handle=this.element.down('.'+options.handle,0);if(!this.handle)this.handle=$(options.handle);if(!this.handle)this.handle=this.element;if(options.scroll&&!options.scroll.scrollTo&&!options.scroll.outerHTML){options.scroll=$(options.scroll);this._isScrollChild=Element.childOf(this.element,options.scroll);}
Element.makePositioned(this.element);this.options=options;this.dragging=false;this.eventMouseDown=this.initDrag.bindAsEventListener(this);Event.observe(this.handle,"mousedown",this.eventMouseDown);Draggables.register(this);},destroy:function(){Event.stopObserving(this.handle,"mousedown",this.eventMouseDown);Draggables.unregister(this);},currentDelta:function(){return([parseInt(Element.getStyle(this.element,'left')||'0'),parseInt(Element.getStyle(this.element,'top')||'0')]);},initDrag:function(event){if(!Object.isUndefined(Draggable._dragging[this.element])&&Draggable._dragging[this.element])return;if(Event.isLeftClick(event)){var src=Event.element(event);if((tag_name=src.tagName.toUpperCase())&&(tag_name=='INPUT'||tag_name=='SELECT'||tag_name=='OPTION'||tag_name=='BUTTON'||tag_name=='TEXTAREA'))return;var pointer=[Event.pointerX(event),Event.pointerY(event)];var pos=Position.cumulativeOffset(this.element);this.offset=[0,1].map(function(i){return(pointer[i]-pos[i])});Draggables.activate(this);Event.stop(event);}},startDrag:function(event){this.dragging=true;if(!this.delta)
this.delta=this.currentDelta();if(this.options.zindex){this.originalZ=parseInt(Element.getStyle(this.element,'z-index')||0);this.element.style.zIndex=this.options.zindex;}
if(this.options.ghosting){this._clone=this.element.cloneNode(true);this.element._originallyAbsolute=(this.element.getStyle('position')=='absolute');if(!this.element._originallyAbsolute)
Position.absolutize(this.element);this.element.parentNode.insertBefore(this._clone,this.element);}
if(this.options.scroll){if(this.options.scroll==window){var where=this._getWindowScroll(this.options.scroll);this.originalScrollLeft=where.left;this.originalScrollTop=where.top;}else{this.originalScrollLeft=this.options.scroll.scrollLeft;this.originalScrollTop=this.options.scroll.scrollTop;}}
Draggables.notify('onStart',this,event);if(this.options.starteffect)this.options.starteffect(this.element);},updateDrag:function(event,pointer){if(!this.dragging)this.startDrag(event);if(!this.options.quiet){Position.prepare();Droppables.show(pointer,this.element);}
Draggables.notify('onDrag',this,event);this.draw(pointer);if(this.options.change)this.options.change(this);if(this.options.scroll){this.stopScrolling();var p;if(this.options.scroll==window){with(this._getWindowScroll(this.options.scroll)){p=[left,top,left+width,top+height];}}else{p=Position.page(this.options.scroll);p[0]+=this.options.scroll.scrollLeft+Position.deltaX;p[1]+=this.options.scroll.scrollTop+Position.deltaY;p.push(p[0]+this.options.scroll.offsetWidth);p.push(p[1]+this.options.scroll.offsetHeight);}
var speed=[0,0];if(pointer[0]<(p[0]+this.options.scrollSensitivity))speed[0]=pointer[0]-(p[0]+this.options.scrollSensitivity);if(pointer[1]<(p[1]+this.options.scrollSensitivity))speed[1]=pointer[1]-(p[1]+this.options.scrollSensitivity);if(pointer[0]>(p[2]-this.options.scrollSensitivity))speed[0]=pointer[0]-(p[2]-this.options.scrollSensitivity);if(pointer[1]>(p[3]-this.options.scrollSensitivity))speed[1]=pointer[1]-(p[3]-this.options.scrollSensitivity);this.startScrolling(speed);}
if(Prototype.Browser.WebKit)window.scrollBy(0,0);Event.stop(event);},finishDrag:function(event,success){this.dragging=false;if(this.options.quiet){Position.prepare();var pointer=[Event.pointerX(event),Event.pointerY(event)];Droppables.show(pointer,this.element);}
if(this.options.ghosting){if(!this.element._originallyAbsolute)
Position.relativize(this.element);delete this.element._originallyAbsolute;Element.remove(this._clone);this._clone=null;}
var dropped=false;if(success){dropped=Droppables.fire(event,this.element);if(!dropped)dropped=false;}
if(dropped&&this.options.onDropped)this.options.onDropped(this.element);Draggables.notify('onEnd',this,event);var revert=this.options.revert;if(revert&&Object.isFunction(revert))revert=revert(this.element);var d=this.currentDelta();if(revert&&this.options.reverteffect){if(dropped==0||revert!='failure')
this.options.reverteffect(this.element,d[1]-this.delta[1],d[0]-this.delta[0]);}else{this.delta=d;}
if(this.options.zindex)
this.element.style.zIndex=this.originalZ;if(this.options.endeffect)
this.options.endeffect(this.element);Draggables.deactivate(this);Droppables.reset();},keyPress:function(event){if(event.keyCode!=Event.KEY_ESC)return;this.finishDrag(event,false);Event.stop(event);},endDrag:function(event){if(!this.dragging)return;this.stopScrolling();this.finishDrag(event,true);Event.stop(event);},draw:function(point){var pos=Position.cumulativeOffset(this.element);if(this.options.ghosting){var r=Position.realOffset(this.element);pos[0]+=r[0]-Position.deltaX;pos[1]+=r[1]-Position.deltaY;}
var d=this.currentDelta();pos[0]-=d[0];pos[1]-=d[1];if(this.options.scroll&&(this.options.scroll!=window&&this._isScrollChild)){pos[0]-=this.options.scroll.scrollLeft-this.originalScrollLeft;pos[1]-=this.options.scroll.scrollTop-this.originalScrollTop;}
var p=[0,1].map(function(i){return(point[i]-pos[i]-this.offset[i])}.bind(this));if(this.options.snap){if(Object.isFunction(this.options.snap)){p=this.options.snap(p[0],p[1],this);}else{if(Object.isArray(this.options.snap)){p=p.map(function(v,i){return(v/this.options.snap[i]).round()*this.options.snap[i]}.bind(this))}else{p=p.map(function(v){return(v/this.options.snap).round()*this.options.snap}.bind(this))}}}
var style=this.element.style;if((!this.options.constraint)||(this.options.constraint=='horizontal'))
style.left=p[0]+"px";if((!this.options.constraint)||(this.options.constraint=='vertical'))
style.top=p[1]+"px";if(style.visibility=="hidden")style.visibility="";},stopScrolling:function(){if(this.scrollInterval){clearInterval(this.scrollInterval);this.scrollInterval=null;Draggables._lastScrollPointer=null;}},startScrolling:function(speed){if(!(speed[0]||speed[1]))return;this.scrollSpeed=[speed[0]*this.options.scrollSpeed,speed[1]*this.options.scrollSpeed];this.lastScrolled=new Date();this.scrollInterval=setInterval(this.scroll.bind(this),10);},scroll:function(){var current=new Date();var delta=current-this.lastScrolled;this.lastScrolled=current;if(this.options.scroll==window){with(this._getWindowScroll(this.options.scroll)){if(this.scrollSpeed[0]||this.scrollSpeed[1]){var d=delta/1000;this.options.scroll.scrollTo(left+d*this.scrollSpeed[0],top+d*this.scrollSpeed[1]);}}}else{this.options.scroll.scrollLeft+=this.scrollSpeed[0]*delta/1000;this.options.scroll.scrollTop+=this.scrollSpeed[1]*delta/1000;}
Position.prepare();Droppables.show(Draggables._lastPointer,this.element);Draggables.notify('onDrag',this);if(this._isScrollChild){Draggables._lastScrollPointer=Draggables._lastScrollPointer||$A(Draggables._lastPointer);Draggables._lastScrollPointer[0]+=this.scrollSpeed[0]*delta/1000;Draggables._lastScrollPointer[1]+=this.scrollSpeed[1]*delta/1000;if(Draggables._lastScrollPointer[0]<0)
Draggables._lastScrollPointer[0]=0;if(Draggables._lastScrollPointer[1]<0)
Draggables._lastScrollPointer[1]=0;this.draw(Draggables._lastScrollPointer);}
if(this.options.change)this.options.change(this);},_getWindowScroll:function(w){var T,L,W,H;with(w.document){if(w.document.documentElement&&documentElement.scrollTop){T=documentElement.scrollTop;L=documentElement.scrollLeft;}else if(w.document.body){T=body.scrollTop;L=body.scrollLeft;}
if(w.innerWidth){W=w.innerWidth;H=w.innerHeight;}else if(w.document.documentElement&&documentElement.clientWidth){W=documentElement.clientWidth;H=documentElement.clientHeight;}else{W=body.offsetWidth;H=body.offsetHeight}}
return{top:T,left:L,width:W,height:H};}});Draggable._dragging={};var SortableObserver=Class.create({initialize:function(element,observer){this.element=$(element);this.observer=observer;this.lastValue=Sortable.serialize(this.element);},onStart:function(){this.lastValue=Sortable.serialize(this.element);},onEnd:function(){Sortable.unmark();if(this.lastValue!=Sortable.serialize(this.element))
this.observer(this.element)}});var Sortable={SERIALIZE_RULE:/^[^_\-](?:[A-Za-z0-9\-\_]*)[_](.*)$/,sortables:{},_findRootElement:function(element){while(element.tagName.toUpperCase()!="BODY"){if(element.id&&Sortable.sortables[element.id])return element;element=element.parentNode;}},options:function(element){element=Sortable._findRootElement($(element));if(!element)return;return Sortable.sortables[element.id];},destroy:function(element){var s=Sortable.options(element);if(s){Draggables.removeObserver(s.element);s.droppables.each(function(d){Droppables.remove(d)});s.draggables.invoke('destroy');delete Sortable.sortables[s.element.id];}},create:function(element){element=$(element);var options=Object.extend({element:element,tag:'li',dropOnEmpty:false,tree:false,treeTag:'ul',overlap:'vertical',constraint:'vertical',containment:element,handle:false,only:false,delay:0,hoverclass:null,ghosting:false,quiet:false,scroll:false,scrollSensitivity:20,scrollSpeed:15,format:this.SERIALIZE_RULE,elements:false,handles:false,onChange:Prototype.emptyFunction,onUpdate:Prototype.emptyFunction},arguments[1]||{});this.destroy(element);var options_for_draggable={revert:true,quiet:options.quiet,scroll:options.scroll,scrollSpeed:options.scrollSpeed,scrollSensitivity:options.scrollSensitivity,delay:options.delay,ghosting:options.ghosting,constraint:options.constraint,handle:options.handle};if(options.starteffect)
options_for_draggable.starteffect=options.starteffect;if(options.reverteffect)
options_for_draggable.reverteffect=options.reverteffect;else
if(options.ghosting)options_for_draggable.reverteffect=function(element){element.style.top=0;element.style.left=0;};if(options.endeffect)
options_for_draggable.endeffect=options.endeffect;if(options.zindex)
options_for_draggable.zindex=options.zindex;var options_for_droppable={overlap:options.overlap,containment:options.containment,tree:options.tree,hoverclass:options.hoverclass,onHover:Sortable.onHover}
var options_for_tree={onHover:Sortable.onEmptyHover,overlap:options.overlap,containment:options.containment,hoverclass:options.hoverclass}
Element.cleanWhitespace(element);options.draggables=[];options.droppables=[];if(options.dropOnEmpty||options.tree){Droppables.add(element,options_for_tree);options.droppables.push(element);}
(options.elements||this.findElements(element,options)||[]).each(function(e,i){var handle=options.handles?$(options.handles[i]):(options.handle?$(e).select('.'+options.handle)[0]:e);options.draggables.push(new Draggable(e,Object.extend(options_for_draggable,{handle:handle})));Droppables.add(e,options_for_droppable);if(options.tree)e.treeNode=element;options.droppables.push(e);});if(options.tree){(Sortable.findTreeElements(element,options)||[]).each(function(e){Droppables.add(e,options_for_tree);e.treeNode=element;options.droppables.push(e);});}
this.sortables[element.id]=options;Draggables.addObserver(new SortableObserver(element,options.onUpdate));},findElements:function(element,options){return Element.findChildren(element,options.only,options.tree?true:false,options.tag);},findTreeElements:function(element,options){return Element.findChildren(element,options.only,options.tree?true:false,options.treeTag);},onHover:function(element,dropon,overlap){if(Element.isParent(dropon,element))return;if(overlap>.33&&overlap<.66&&Sortable.options(dropon).tree){return;}else if(overlap>0.5){Sortable.mark(dropon,'before');if(dropon.previousSibling!=element){var oldParentNode=element.parentNode;element.style.visibility="hidden";dropon.parentNode.insertBefore(element,dropon);if(dropon.parentNode!=oldParentNode)
Sortable.options(oldParentNode).onChange(element);Sortable.options(dropon.parentNode).onChange(element);}}else{Sortable.mark(dropon,'after');var nextElement=dropon.nextSibling||null;if(nextElement!=element){var oldParentNode=element.parentNode;element.style.visibility="hidden";dropon.parentNode.insertBefore(element,nextElement);if(dropon.parentNode!=oldParentNode)
Sortable.options(oldParentNode).onChange(element);Sortable.options(dropon.parentNode).onChange(element);}}},onEmptyHover:function(element,dropon,overlap){var oldParentNode=element.parentNode;var droponOptions=Sortable.options(dropon);if(!Element.isParent(dropon,element)){var index;var children=Sortable.findElements(dropon,{tag:droponOptions.tag,only:droponOptions.only});var child=null;if(children){var offset=Element.offsetSize(dropon,droponOptions.overlap)*(1.0-overlap);for(index=0;index<children.length;index+=1){if(offset-Element.offsetSize(children[index],droponOptions.overlap)>=0){offset-=Element.offsetSize(children[index],droponOptions.overlap);}else if(offset-(Element.offsetSize(children[index],droponOptions.overlap)/2)>=0){child=index+1<children.length?children[index+1]:null;break;}else{child=children[index];break;}}}
dropon.insertBefore(element,child);Sortable.options(oldParentNode).onChange(element);droponOptions.onChange(element);}},unmark:function(){if(Sortable._marker)Sortable._marker.hide();},mark:function(dropon,position){var sortable=Sortable.options(dropon.parentNode);if(sortable&&!sortable.ghosting)return;if(!Sortable._marker){Sortable._marker=($('dropmarker')||Element.extend(document.createElement('DIV'))).hide().addClassName('dropmarker').setStyle({position:'absolute'});document.getElementsByTagName("body").item(0).appendChild(Sortable._marker);}
var offsets=Position.cumulativeOffset(dropon);Sortable._marker.setStyle({left:offsets[0]+'px',top:offsets[1]+'px'});if(position=='after')
if(sortable.overlap=='horizontal')
Sortable._marker.setStyle({left:(offsets[0]+dropon.clientWidth)+'px'});else
Sortable._marker.setStyle({top:(offsets[1]+dropon.clientHeight)+'px'});Sortable._marker.show();},_tree:function(element,options,parent){var children=Sortable.findElements(element,options)||[];for(var i=0;i<children.length;++i){var match=children[i].id.match(options.format);if(!match)continue;var child={id:encodeURIComponent(match?match[1]:null),element:element,parent:parent,children:[],position:parent.children.length,container:$(children[i]).down(options.treeTag)}
if(child.container)
this._tree(child.container,options,child)
parent.children.push(child);}
return parent;},tree:function(element){element=$(element);var sortableOptions=this.options(element);var options=Object.extend({tag:sortableOptions.tag,treeTag:sortableOptions.treeTag,only:sortableOptions.only,name:element.id,format:sortableOptions.format},arguments[1]||{});var root={id:null,parent:null,children:[],container:element,position:0}
return Sortable._tree(element,options,root);},_constructIndex:function(node){var index='';do{if(node.id)index='['+node.position+']'+index;}while((node=node.parent)!=null);return index;},sequence:function(element){element=$(element);var options=Object.extend(this.options(element),arguments[1]||{});return $(this.findElements(element,options)||[]).map(function(item){return item.id.match(options.format)?item.id.match(options.format)[1]:'';});},setSequence:function(element,new_sequence){element=$(element);var options=Object.extend(this.options(element),arguments[2]||{});var nodeMap={};this.findElements(element,options).each(function(n){if(n.id.match(options.format))
nodeMap[n.id.match(options.format)[1]]=[n,n.parentNode];n.parentNode.removeChild(n);});new_sequence.each(function(ident){var n=nodeMap[ident];if(n){n[1].appendChild(n[0]);delete nodeMap[ident];}});},serialize:function(element){element=$(element);var options=Object.extend(Sortable.options(element),arguments[1]||{});var name=encodeURIComponent((arguments[1]&&arguments[1].name)?arguments[1].name:element.id);if(options.tree){return Sortable.tree(element,arguments[1]).children.map(function(item){return[name+Sortable._constructIndex(item)+"[id]="+
encodeURIComponent(item.id)].concat(item.children.map(arguments.callee));}).flatten().join('&');}else{return Sortable.sequence(element,arguments[1]).map(function(item){return name+"[]="+encodeURIComponent(item);}).join('&');}}}
Element.isParent=function(child,element){if(!child.parentNode||child==element)return false;if(child.parentNode==element)return true;return Element.isParent(child.parentNode,element);}
Element.findChildren=function(element,only,recursive,tagName){if(!element.hasChildNodes())return null;tagName=tagName.toUpperCase();if(only)only=[only].flatten();var elements=[];$A(element.childNodes).each(function(e){if(e.tagName&&e.tagName.toUpperCase()==tagName&&(!only||(Element.classNames(e).detect(function(v){return only.include(v)}))))
elements.push(e);if(recursive){var grandchildren=Element.findChildren(e,only,recursive,tagName);if(grandchildren)elements.push(grandchildren);}});return(elements.length>0?elements.flatten():[]);}
Element.offsetSize=function(element,type){return element['offset'+((type=='vertical'||type=='height')?'Height':'Width')];}
			AUTOCORE_SELF_CHECK = null;
		
			// File : /okcontent/js/scriptaculous-1.8.1-for-autocore/slider.js
			AUTOCORE_SELF_CHECK = "/okcontent/js/scriptaculous-1.8.1-for-autocore/slider.js";
			
if(!Control)var Control={};Control.Slider=Class.create({initialize:function(handle,track,options){var slider=this;if(Object.isArray(handle)){this.handles=handle.collect(function(e){return $(e)});}else{this.handles=[$(handle)];}
this.track=$(track);this.options=options||{};this.axis=this.options.axis||'horizontal';this.increment=this.options.increment||1;this.step=parseInt(this.options.step||'1');this.range=this.options.range||$R(0,1);this.value=0;this.values=this.handles.map(function(){return 0});this.spans=this.options.spans?this.options.spans.map(function(s){return $(s)}):false;this.options.startSpan=$(this.options.startSpan||null);this.options.endSpan=$(this.options.endSpan||null);this.restricted=this.options.restricted||false;this.maximum=this.options.maximum||this.range.end;this.minimum=this.options.minimum||this.range.start;this.alignX=parseInt(this.options.alignX||'0');this.alignY=parseInt(this.options.alignY||'0');this.trackLength=this.maximumOffset()-this.minimumOffset();this.handleLength=this.isVertical()?(this.handles[0].offsetHeight!=0?this.handles[0].offsetHeight:this.handles[0].style.height.replace(/px$/,"")):(this.handles[0].offsetWidth!=0?this.handles[0].offsetWidth:this.handles[0].style.width.replace(/px$/,""));this.active=false;this.dragging=false;this.disabled=false;if(this.options.disabled)this.setDisabled();this.allowedValues=this.options.values?this.options.values.sortBy(Prototype.K):false;if(this.allowedValues){this.minimum=this.allowedValues.min();this.maximum=this.allowedValues.max();}
this.eventMouseDown=this.startDrag.bindAsEventListener(this);this.eventMouseUp=this.endDrag.bindAsEventListener(this);this.eventMouseMove=this.update.bindAsEventListener(this);this.handles.each(function(h,i){i=slider.handles.length-1-i;slider.setValue(parseFloat((Object.isArray(slider.options.sliderValue)?slider.options.sliderValue[i]:slider.options.sliderValue)||slider.range.start),i);h.makePositioned().observe("mousedown",slider.eventMouseDown);});this.track.observe("mousedown",this.eventMouseDown);document.observe("mouseup",this.eventMouseUp);document.observe("mousemove",this.eventMouseMove);this.initialized=true;},dispose:function(){var slider=this;Event.stopObserving(this.track,"mousedown",this.eventMouseDown);Event.stopObserving(document,"mouseup",this.eventMouseUp);Event.stopObserving(document,"mousemove",this.eventMouseMove);this.handles.each(function(h){Event.stopObserving(h,"mousedown",slider.eventMouseDown);});},setDisabled:function(){this.disabled=true;},setEnabled:function(){this.disabled=false;},getNearestValue:function(value){if(this.allowedValues){if(value>=this.allowedValues.max())return(this.allowedValues.max());if(value<=this.allowedValues.min())return(this.allowedValues.min());var offset=Math.abs(this.allowedValues[0]-value);var newValue=this.allowedValues[0];this.allowedValues.each(function(v){var currentOffset=Math.abs(v-value);if(currentOffset<=offset){newValue=v;offset=currentOffset;}});return newValue;}
if(value>this.range.end)return this.range.end;if(value<this.range.start)return this.range.start;return value;},setValue:function(sliderValue,handleIdx){if(!this.active){this.activeHandleIdx=handleIdx||0;this.activeHandle=this.handles[this.activeHandleIdx];this.updateStyles();}
handleIdx=handleIdx||this.activeHandleIdx||0;if(this.initialized&&this.restricted){if((handleIdx>0)&&(sliderValue<this.values[handleIdx-1]))
sliderValue=this.values[handleIdx-1];if((handleIdx<(this.handles.length-1))&&(sliderValue>this.values[handleIdx+1]))
sliderValue=this.values[handleIdx+1];}
sliderValue=this.getNearestValue(sliderValue);this.values[handleIdx]=sliderValue;this.value=this.values[0];this.handles[handleIdx].style[this.isVertical()?'top':'left']=this.translateToPx(sliderValue);this.drawSpans();if(!this.dragging||!this.event)this.updateFinished();},setValueBy:function(delta,handleIdx){this.setValue(this.values[handleIdx||this.activeHandleIdx||0]+delta,handleIdx||this.activeHandleIdx||0);},translateToPx:function(value){return Math.round(((this.trackLength-this.handleLength)/(this.range.end-this.range.start))*(value-this.range.start))+"px";},translateToValue:function(offset){return((offset/(this.trackLength-this.handleLength)*(this.range.end-this.range.start))+this.range.start);},getRange:function(range){var v=this.values.sortBy(Prototype.K);range=range||0;return $R(v[range],v[range+1]);},minimumOffset:function(){return(this.isVertical()?this.alignY:this.alignX);},maximumOffset:function(){return(this.isVertical()?(this.track.offsetHeight!=0?this.track.offsetHeight:this.track.style.height.replace(/px$/,""))-this.alignY:(this.track.offsetWidth!=0?this.track.offsetWidth:this.track.style.width.replace(/px$/,""))-this.alignX);},isVertical:function(){return(this.axis=='vertical');},drawSpans:function(){var slider=this;if(this.spans)
$R(0,this.spans.length-1).each(function(r){slider.setSpan(slider.spans[r],slider.getRange(r))});if(this.options.startSpan)
this.setSpan(this.options.startSpan,$R(0,this.values.length>1?this.getRange(0).min():this.value));if(this.options.endSpan)
this.setSpan(this.options.endSpan,$R(this.values.length>1?this.getRange(this.spans.length-1).max():this.value,this.maximum));},setSpan:function(span,range){if(this.isVertical()){span.style.top=this.translateToPx(range.start);span.style.height=this.translateToPx(range.end-range.start+this.range.start);}else{span.style.left=this.translateToPx(range.start);span.style.width=this.translateToPx(range.end-range.start+this.range.start);}},updateStyles:function(){this.handles.each(function(h){Element.removeClassName(h,'selected')});Element.addClassName(this.activeHandle,'selected');},startDrag:function(event){if(Event.isLeftClick(event)){if(!this.disabled){this.active=true;var handle=Event.element(event);var pointer=[Event.pointerX(event),Event.pointerY(event)];var track=handle;if(track==this.track){var offsets=Position.cumulativeOffset(this.track);this.event=event;this.setValue(this.translateToValue((this.isVertical()?pointer[1]-offsets[1]:pointer[0]-offsets[0])-(this.handleLength/2)));var offsets=Position.cumulativeOffset(this.activeHandle);this.offsetX=(pointer[0]-offsets[0]);this.offsetY=(pointer[1]-offsets[1]);}else{while((this.handles.indexOf(handle)==-1)&&handle.parentNode)
handle=handle.parentNode;if(this.handles.indexOf(handle)!=-1){this.activeHandle=handle;this.activeHandleIdx=this.handles.indexOf(this.activeHandle);this.updateStyles();var offsets=Position.cumulativeOffset(this.activeHandle);this.offsetX=(pointer[0]-offsets[0]);this.offsetY=(pointer[1]-offsets[1]);}}}
Event.stop(event);}},update:function(event){if(this.active){if(!this.dragging)this.dragging=true;this.draw(event);if(Prototype.Browser.WebKit)window.scrollBy(0,0);Event.stop(event);}},draw:function(event){var pointer=[Event.pointerX(event),Event.pointerY(event)];var offsets=Position.cumulativeOffset(this.track);pointer[0]-=this.offsetX+offsets[0];pointer[1]-=this.offsetY+offsets[1];this.event=event;this.setValue(this.translateToValue(this.isVertical()?pointer[1]:pointer[0]));if(this.initialized&&this.options.onSlide)
this.options.onSlide(this.values.length>1?this.values:this.value,this);},endDrag:function(event){if(this.active&&this.dragging){this.finishDrag(event,true);Event.stop(event);}
this.active=false;this.dragging=false;},finishDrag:function(event,success){this.active=false;this.dragging=false;this.updateFinished();},updateFinished:function(){if(this.initialized&&this.options.onChange)
this.options.onChange(this.values.length>1?this.values:this.value,this);this.event=null;}});
			AUTOCORE_SELF_CHECK = null;
		
			// File : /okcontent/js/cropper/cropper-for-autocore.js
			AUTOCORE_SELF_CHECK = "/okcontent/js/cropper/cropper-for-autocore.js";
			
if(Draggable){var CropDraggable=Class.create();Object.extend(Object.extend(CropDraggable.prototype,Draggable.prototype),{initialize:function(_1){this.options=Object.extend({drawMethod:function(){}},arguments[1]||{});this.element=$(_1);this.handle=this.element;this.delta=this.currentDelta();this.dragging=false;this.eventMouseDown=this.initDrag.bindAsEventListener(this);Event.observe(this.handle,"mousedown",this.eventMouseDown);Draggables.register(this);},draw:function(_2){var _3=Position.cumulativeOffset(this.element);var d=this.currentDelta();_3[0]-=d[0];_3[1]-=d[1];var p=[0,1].map(function(i){return(_2[i]-_3[i]-this.offset[i]);}.bind(this));this.options.drawMethod(p);}});var Cropper={};Cropper.Img=Class.create();Cropper.Img.prototype={initialize:function(_7,_8){this.options=Object.extend({ratioDim:{x:0,y:0},minWidth:0,minHeight:0,displayOnInit:false,onEndCrop:Prototype.emptyFunction,captureKeys:true,onloadCoords:null,maxWidth:0,maxHeight:0},_8||{});this.img=$(_7);this.clickCoords={x:0,y:0};this.dragging=false;this.resizing=false;this.isWebKit=/Konqueror|Safari|KHTML/.test(navigator.userAgent);this.isIE=/MSIE/.test(navigator.userAgent);this.isOpera8=/Opera\s[1-8]/.test(navigator.userAgent);this.ratioX=0;this.ratioY=0;this.attached=false;this.fixedWidth=(this.options.maxWidth>0&&(this.options.minWidth>=this.options.maxWidth));this.fixedHeight=(this.options.maxHeight>0&&(this.options.minHeight>=this.options.maxHeight));if(typeof this.img=="undefined"){return;}
$A(document.getElementsByTagName("script")).each(function(s){if(s.src.match(/cropper\.js/)){var _a=s.src.replace(/cropper\.js(.*)?/,"");var _b=document.createElement("link");_b.rel="stylesheet";_b.type="text/css";_b.href=_a+"cropper.css";_b.media="screen";document.getElementsByTagName("head")[0].appendChild(_b);}});if(this.options.ratioDim.x>0&&this.options.ratioDim.y>0){var _c=this.getGCD(this.options.ratioDim.x,this.options.ratioDim.y);this.ratioX=this.options.ratioDim.x/_c;this.ratioY=this.options.ratioDim.y/_c;}
this.subInitialize();if(this.img.complete||this.isWebKit){this.onLoad();}else{Event.observe(this.img,"load",this.onLoad.bindAsEventListener(this));}},getGCD:function(a,b){if(b==0){return a;}
return this.getGCD(b,a%b);},onLoad:function(){var _f="imgCrop_";var _10=this.img.parentNode;var _11="";if(this.isOpera8){_11=" opera8";}
this.imgWrap=Builder.node("div",{"class":_f+"wrap"+_11});this.north=Builder.node("div",{"class":_f+"overlay "+_f+"north"},[Builder.node("span")]);this.east=Builder.node("div",{"class":_f+"overlay "+_f+"east"},[Builder.node("span")]);this.south=Builder.node("div",{"class":_f+"overlay "+_f+"south"},[Builder.node("span")]);this.west=Builder.node("div",{"class":_f+"overlay "+_f+"west"},[Builder.node("span")]);var _12=[this.north,this.east,this.south,this.west];this.dragArea=Builder.node("div",{"class":_f+"dragArea"},_12);this.handleN=Builder.node("div",{"class":_f+"handle "+_f+"handleN"});this.handleNE=Builder.node("div",{"class":_f+"handle "+_f+"handleNE"});this.handleE=Builder.node("div",{"class":_f+"handle "+_f+"handleE"});this.handleSE=Builder.node("div",{"class":_f+"handle "+_f+"handleSE"});this.handleS=Builder.node("div",{"class":_f+"handle "+_f+"handleS"});this.handleSW=Builder.node("div",{"class":_f+"handle "+_f+"handleSW"});this.handleW=Builder.node("div",{"class":_f+"handle "+_f+"handleW"});this.handleNW=Builder.node("div",{"class":_f+"handle "+_f+"handleNW"});this.selArea=Builder.node("div",{"class":_f+"selArea"},[Builder.node("div",{"class":_f+"marqueeHoriz "+_f+"marqueeNorth"},[Builder.node("span")]),Builder.node("div",{"class":_f+"marqueeVert "+_f+"marqueeEast"},[Builder.node("span")]),Builder.node("div",{"class":_f+"marqueeHoriz "+_f+"marqueeSouth"},[Builder.node("span")]),Builder.node("div",{"class":_f+"marqueeVert "+_f+"marqueeWest"},[Builder.node("span")]),this.handleN,this.handleNE,this.handleE,this.handleSE,this.handleS,this.handleSW,this.handleW,this.handleNW,Builder.node("div",{"class":_f+"clickArea"})]);this.imgWrap.appendChild(this.img);this.imgWrap.appendChild(this.dragArea);this.dragArea.appendChild(this.selArea);this.dragArea.appendChild(Builder.node("div",{"class":_f+"clickArea"}));_10.appendChild(this.imgWrap);this.startDragBind=this.startDrag.bindAsEventListener(this);Event.observe(this.dragArea,"mousedown",this.startDragBind);this.onDragBind=this.onDrag.bindAsEventListener(this);Event.observe(document,"mousemove",this.onDragBind);this.endCropBind=this.endCrop.bindAsEventListener(this);Event.observe(document,"mouseup",this.endCropBind);this.resizeBind=this.startResize.bindAsEventListener(this);this.handles=[this.handleN,this.handleNE,this.handleE,this.handleSE,this.handleS,this.handleSW,this.handleW,this.handleNW];this.registerHandles(true);if(this.options.captureKeys){this.keysBind=this.handleKeys.bindAsEventListener(this);Event.observe(document,"keypress",this.keysBind);}
new CropDraggable(this.selArea,{drawMethod:this.moveArea.bindAsEventListener(this)});this.setParams();},registerHandles:function(_13){for(var i=0;i<this.handles.length;i++){var _15=$(this.handles[i]);if(_13){var _16=false;if(this.fixedWidth&&this.fixedHeight){_16=true;}else{if(this.fixedWidth||this.fixedHeight){var _17=_15.className.match(/([S|N][E|W])$/);var _18=_15.className.match(/(E|W)$/);var _19=_15.className.match(/(N|S)$/);if(_17){_16=true;}else{if(this.fixedWidth&&_18){_16=true;}else{if(this.fixedHeight&&_19){_16=true;}}}}}
if(_16){_15.hide();}else{Event.observe(_15,"mousedown",this.resizeBind);}}else{_15.show();Event.stopObserving(_15,"mousedown",this.resizeBind);}}},setParams:function(){this.imgW=this.img.width;this.imgH=this.img.height;$(this.north).setStyle({height:0});$(this.east).setStyle({width:0,height:0});$(this.south).setStyle({height:0});$(this.west).setStyle({width:0,height:0});$(this.imgWrap).setStyle({"width":this.imgW+"px","height":this.imgH+"px"});$(this.selArea).hide();var _1a={x1:0,y1:0,x2:0,y2:0};var _1b=false;if(this.options.onloadCoords!=null){_1a=this.cloneCoords(this.options.onloadCoords);_1b=true;}else{if(this.options.ratioDim.x>0&&this.options.ratioDim.y>0){_1a.x1=Math.ceil((this.imgW-this.options.ratioDim.x)/2);_1a.y1=Math.ceil((this.imgH-this.options.ratioDim.y)/2);_1a.x2=_1a.x1+this.options.ratioDim.x;_1a.y2=_1a.y1+this.options.ratioDim.y;_1b=true;}}
this.setAreaCoords(_1a,false,false,1);if(this.options.displayOnInit&&_1b){this.selArea.show();this.drawArea();this.endCrop();}
this.attached=true;},remove:function(){if(this.attached){this.attached=false;this.imgWrap.parentNode.insertBefore(this.img,this.imgWrap);this.imgWrap.parentNode.removeChild(this.imgWrap);Event.stopObserving(this.dragArea,"mousedown",this.startDragBind);Event.stopObserving(document,"mousemove",this.onDragBind);Event.stopObserving(document,"mouseup",this.endCropBind);this.registerHandles(false);if(this.options.captureKeys){Event.stopObserving(document,"keypress",this.keysBind);}}},reset:function(){if(!this.attached){this.onLoad();}else{this.setParams();}
this.endCrop();},handleKeys:function(e){var dir={x:0,y:0};if(!this.dragging){switch(e.keyCode){case(37):dir.x=-1;break;case(38):dir.y=-1;break;case(39):dir.x=1;break;case(40):dir.y=1;break;}
if(dir.x!=0||dir.y!=0){if(e.shiftKey){dir.x*=10;dir.y*=10;}
this.moveArea([this.areaCoords.x1+dir.x,this.areaCoords.y1+dir.y]);Event.stop(e);}}},calcW:function(){return(this.areaCoords.x2-this.areaCoords.x1);},calcH:function(){return(this.areaCoords.y2-this.areaCoords.y1);},moveArea:function(_1e){this.setAreaCoords({x1:_1e[0],y1:_1e[1],x2:_1e[0]+this.calcW(),y2:_1e[1]+this.calcH()},true,false);this.drawArea();},cloneCoords:function(_1f){return{x1:_1f.x1,y1:_1f.y1,x2:_1f.x2,y2:_1f.y2};},setAreaCoords:function(_20,_21,_22,_23,_24){if(_21){var _25=_20.x2-_20.x1;var _26=_20.y2-_20.y1;if(_20.x1<0){_20.x1=0;_20.x2=_25;}
if(_20.y1<0){_20.y1=0;_20.y2=_26;}
if(_20.x2>this.imgW){_20.x2=this.imgW;_20.x1=this.imgW-_25;}
if(_20.y2>this.imgH){_20.y2=this.imgH;_20.y1=this.imgH-_26;}}else{if(_20.x1<0){_20.x1=0;}
if(_20.y1<0){_20.y1=0;}
if(_20.x2>this.imgW){_20.x2=this.imgW;}
if(_20.y2>this.imgH){_20.y2=this.imgH;}
if(_23!=null){if(this.ratioX>0){this.applyRatio(_20,{x:this.ratioX,y:this.ratioY},_23,_24);}else{if(_22){this.applyRatio(_20,{x:1,y:1},_23,_24);}}
var _27=[this.options.minWidth,this.options.minHeight];var _28=[this.options.maxWidth,this.options.maxHeight];if(_27[0]>0||_27[1]>0||_28[0]>0||_28[1]>0){var _29={a1:_20.x1,a2:_20.x2};var _2a={a1:_20.y1,a2:_20.y2};var _2b={min:0,max:this.imgW};var _2c={min:0,max:this.imgH};if((_27[0]!=0||_27[1]!=0)&&_22){if(_27[0]>0){_27[1]=_27[0];}else{if(_27[1]>0){_27[0]=_27[1];}}}
if((_28[0]!=0||_28[0]!=0)&&_22){if(_28[0]>0&&_28[0]<=_28[1]){_28[1]=_28[0];}else{if(_28[1]>0&&_28[1]<=_28[0]){_28[0]=_28[1];}}}
if(_27[0]>0){this.applyDimRestriction(_29,_27[0],_23.x,_2b,"min");}
if(_27[1]>1){this.applyDimRestriction(_2a,_27[1],_23.y,_2c,"min");}
if(_28[0]>0){this.applyDimRestriction(_29,_28[0],_23.x,_2b,"max");}
if(_28[1]>1){this.applyDimRestriction(_2a,_28[1],_23.y,_2c,"max");}
_20={x1:_29.a1,y1:_2a.a1,x2:_29.a2,y2:_2a.a2};}}}
this.areaCoords=_20;},applyDimRestriction:function(_2d,val,_2f,_30,_31){var _32;if(_31=="min"){_32=((_2d.a2-_2d.a1)<val);}else{_32=((_2d.a2-_2d.a1)>val);}
if(_32){if(_2f==1){_2d.a2=_2d.a1+val;}else{_2d.a1=_2d.a2-val;}
if(_2d.a1<_30.min){_2d.a1=_30.min;_2d.a2=val;}else{if(_2d.a2>_30.max){_2d.a1=_30.max-val;_2d.a2=_30.max;}}}},applyRatio:function(_33,_34,_35,_36){var _37;if(_36=="N"||_36=="S"){_37=this.applyRatioToAxis({a1:_33.y1,b1:_33.x1,a2:_33.y2,b2:_33.x2},{a:_34.y,b:_34.x},{a:_35.y,b:_35.x},{min:0,max:this.imgW});_33.x1=_37.b1;_33.y1=_37.a1;_33.x2=_37.b2;_33.y2=_37.a2;}else{_37=this.applyRatioToAxis({a1:_33.x1,b1:_33.y1,a2:_33.x2,b2:_33.y2},{a:_34.x,b:_34.y},{a:_35.x,b:_35.y},{min:0,max:this.imgH});_33.x1=_37.a1;_33.y1=_37.b1;_33.x2=_37.a2;_33.y2=_37.b2;}},applyRatioToAxis:function(_38,_39,_3a,_3b){var _3c=Object.extend(_38,{});var _3d=_3c.a2-_3c.a1;var _3e=Math.floor(_3d*_39.b/_39.a);var _3f;var _40;var _41=null;if(_3a.b==1){_3f=_3c.b1+_3e;if(_3f>_3b.max){_3f=_3b.max;_41=_3f-_3c.b1;}
_3c.b2=_3f;}else{_3f=_3c.b2-_3e;if(_3f<_3b.min){_3f=_3b.min;_41=_3f+_3c.b2;}
_3c.b1=_3f;}
if(_41!=null){_40=Math.floor(_41*_39.a/_39.b);if(_3a.a==1){_3c.a2=_3c.a1+_40;}else{_3c.a1=_3c.a1=_3c.a2-_40;}}
return _3c;},drawArea:function(){var _42=this.calcW();var _43=this.calcH();var px="px";var _45=[this.areaCoords.x1+px,this.areaCoords.y1+px,_42+px,_43+px,this.areaCoords.x2+px,this.areaCoords.y2+px,(this.img.width-this.areaCoords.x2)+px,(this.img.height-this.areaCoords.y2)+px];var _46=this.selArea.style;_46.left=_45[0];_46.top=_45[1];_46.width=_45[2];_46.height=_45[3];var _47=Math.ceil((_42-6)/2)+px;var _48=Math.ceil((_43-6)/2)+px;this.handleN.style.left=_47;this.handleE.style.top=_48;this.handleS.style.left=_47;this.handleW.style.top=_48;this.north.style.height=_45[1];var _49=this.east.style;_49.top=_45[1];_49.height=_45[3];_49.left=_45[4];_49.width=_45[6];var _4a=this.south.style;_4a.top=_45[5];_4a.height=_45[7];var _4b=this.west.style;_4b.top=_45[1];_4b.height=_45[3];_4b.width=_45[0];this.subDrawArea();this.forceReRender();},forceReRender:function(){if(this.isIE||this.isWebKit){var n=document.createTextNode(" ");var d,el,fixEL,i;if(this.isIE){fixEl=this.selArea;}else{if(this.isWebKit){fixEl=document.getElementsByClassName("imgCrop_marqueeSouth",this.imgWrap)[0];d=Builder.node("div","");d.style.visibility="hidden";var _4e=["SE","S","SW"];for(i=0;i<_4e.length;i++){el=document.getElementsByClassName("imgCrop_handle"+_4e[i],this.selArea)[0];if(el.childNodes.length){el.removeChild(el.childNodes[0]);}
el.appendChild(d);}}}
fixEl.appendChild(n);fixEl.removeChild(n);}},startResize:function(e){this.startCoords=this.cloneCoords(this.areaCoords);this.resizing=true;this.resizeHandle=Event.element(e).classNames().toString().replace(/([^N|NE|E|SE|S|SW|W|NW])+/,"");Event.stop(e);},startDrag:function(e){this.selArea.show();this.clickCoords=this.getCurPos(e);this.setAreaCoords({x1:this.clickCoords.x,y1:this.clickCoords.y,x2:this.clickCoords.x,y2:this.clickCoords.y},false,false,null);this.dragging=true;this.onDrag(e);Event.stop(e);},getCurPos:function(e){var el=this.imgWrap,wrapOffsets=Position.cumulativeOffset(el);while(el.nodeName!="BODY"){wrapOffsets[1]-=el.scrollTop||0;wrapOffsets[0]-=el.scrollLeft||0;el=el.parentNode;}
return curPos={x:Event.pointerX(e)-wrapOffsets[0],y:Event.pointerY(e)-wrapOffsets[1]};},onDrag:function(e){if(this.dragging||this.resizing){var _54=null;var _55=this.getCurPos(e);var _56=this.cloneCoords(this.areaCoords);var _57={x:1,y:1};if(this.dragging){if(_55.x<this.clickCoords.x){_57.x=-1;}
if(_55.y<this.clickCoords.y){_57.y=-1;}
this.transformCoords(_55.x,this.clickCoords.x,_56,"x");this.transformCoords(_55.y,this.clickCoords.y,_56,"y");}else{if(this.resizing){_54=this.resizeHandle;if(_54.match(/E/)){this.transformCoords(_55.x,this.startCoords.x1,_56,"x");if(_55.x<this.startCoords.x1){_57.x=-1;}}else{if(_54.match(/W/)){this.transformCoords(_55.x,this.startCoords.x2,_56,"x");if(_55.x<this.startCoords.x2){_57.x=-1;}}}
if(_54.match(/N/)){this.transformCoords(_55.y,this.startCoords.y2,_56,"y");if(_55.y<this.startCoords.y2){_57.y=-1;}}else{if(_54.match(/S/)){this.transformCoords(_55.y,this.startCoords.y1,_56,"y");if(_55.y<this.startCoords.y1){_57.y=-1;}}}}}
this.setAreaCoords(_56,false,e.shiftKey,_57,_54);this.drawArea();Event.stop(e);}},transformCoords:function(_58,_59,_5a,_5b){var _5c=[_58,_59];if(_58>_59){_5c.reverse();}
_5a[_5b+"1"]=_5c[0];_5a[_5b+"2"]=_5c[1];},endCrop:function(){this.dragging=false;this.resizing=false;this.options.onEndCrop(this.areaCoords,{width:this.calcW(),height:this.calcH()});},subInitialize:function(){},subDrawArea:function(){}};Cropper.ImgWithPreview=Class.create();Object.extend(Object.extend(Cropper.ImgWithPreview.prototype,Cropper.Img.prototype),{subInitialize:function(){this.hasPreviewImg=false;if(typeof(this.options.previewWrap)!="undefined"&&this.options.minWidth>0&&this.options.minHeight>0){this.previewWrap=$(this.options.previewWrap);this.previewImg=this.img.cloneNode(false);this.previewImg.id="imgCrop_"+this.previewImg.id;this.options.displayOnInit=true;this.hasPreviewImg=true;this.previewWrap.addClassName("imgCrop_previewWrap");this.previewWrap.setStyle({width:this.options.minWidth+"px",height:this.options.minHeight+"px"});this.previewWrap.appendChild(this.previewImg);}},subDrawArea:function(){if(this.hasPreviewImg){var _5d=this.calcW();var _5e=this.calcH();var _5f={x:this.imgW/_5d,y:this.imgH/_5e};var _60={x:_5d/this.options.minWidth,y:_5e/this.options.minHeight};var _61={w:Math.ceil(this.options.minWidth*_5f.x)+"px",h:Math.ceil(this.options.minHeight*_5f.y)+"px",x:"-"+Math.ceil(this.areaCoords.x1/_60.x)+"px",y:"-"+Math.ceil(this.areaCoords.y1/_60.y)+"px"};var _62=this.previewImg.style;_62.width=_61.w;_62.height=_61.h;_62.left=_61.x;_62.top=_61.y;}}});}
			AUTOCORE_SELF_CHECK = null;
		
			// File : /okcontent/js/GrazeCoverManager.js
			AUTOCORE_SELF_CHECK = "/okcontent/js/GrazeCoverManager.js";
			
var GrazeCoverManager={StaticTimeout:1000,MovingTimeout:2000,MonitorLoop:100,StaticTimers:{},MovingTimers:{},HighestKnownZIndex:null,Initialize:function(){setTimeout(this.WatchForGrazeRegions.bind(this),this.MonitorLoop);},RemoveTimers:function(id){if(_GCM.StaticTimers[id]){clearTimeout(_GCM.StaticTimers[id]);_GCM.StaticTimers[id]=null;}
if(_GCM.MovingTimers[id]){clearTimeout(_GCM.MovingTimers[id]);_GCM.MovingTimers[id]=null;}},RemoveCover:function(id){$(id).style.display="none";_GCM.RemoveTimers(id);},UpdateHighestKnownZIndex:function(z){z=+(z);if(!this.HighestKnownZIndex||this.HighestKnownZIndex<z){this.HighestKnownZIndex=z;}},AddCoverIfMissing:function(el,id){var new_div_id=id+"_graze_cover";if(!$(new_div_id)&&el.style.left!="0"&&el.style.left!="0px"){var new_div=top.document.createElement("div");new_div.id=new_div_id;new_div.style.backgroundColor="#ddd";new_div.style.position=el.style.position;new_div.style.display=el.style.display;new_div.style.left=el.style.left;new_div.style.top=el.style.top;new_div.style.width=el.style.width;new_div.style.height=el.style.height;new_div.style.zIndex=parseInt(el.style.zIndex)+1;this.UpdateHighestKnownZIndex(new_div.style.zIndex);if(window.location.href.indexOf("show_graze_covers")==-1){new_div.style.opacity=0;new_div.style.filter='alpha(opacity=0)';}
$(id).insert({"before":new_div});this.AddEventListeners(el,id,new_div_id);}},AddPointrollCoverIfMissing:function(el,id){var new_div_id=id+"_graze_cover";var el=$(el);var width=el.getWidth(),height=el.getHeight();if(!$(new_div_id)&&width&&height){var new_div=top.document.createElement('div');new_div.id=new_div_id;new_div.className='grazecover';new_div.style.backgroundColor="#ddd";new_div.style.position='absolute';new_div.style.display='block';new_div.style.width=width+'px';new_div.style.height=height+'px';new_div.style.zIndex=el.style.zIndex?parseInt(el.style.zIndex)+1:100;if(window.location.href.indexOf("show_graze_covers")==-1){new_div.style.opacity=0;new_div.style.filter='alpha(opacity=0)';}
$(id).insert({"before":new_div});this.AddEventListeners(el,id,new_div_id);}},AddEventListeners:function(el,id,new_div_id){$(new_div_id).observe('mousemove',function(evt){if(_GCM.StaticTimers[new_div_id])
clearTimeout(_GCM.StaticTimers[new_div_id]);_GCM.StaticTimers[new_div_id]=setTimeout(function(){_GCM.RemoveCover(new_div_id);},_GCM.StaticTimeout);});$(new_div_id).observe('mouseover',function(evt){_GCM.MovingTimers[new_div_id]=setTimeout(function(){_GCM.RemoveCover(new_div_id);},_GCM.MovingTimeout);});$(new_div_id).observe('mouseout',function(evt){_GCM.RemoveTimers(new_div_id);});$(new_div_id).observe('click',function(evt){_GCM.RemoveCover(new_div_id);});},KeepCoversInPlace:function(id){var ad=$(id);var cover=$(id+"_graze_cover");if(ad&&cover){if(cover.style.left!=ad.style.left)cover.style.left=ad.style.left;if(cover.style.top!=ad.style.top)cover.style.top=ad.style.top;if(cover.style.position!=ad.style.position)cover.style.position=ad.style.position;if(cover.style.display!=ad.style.display&&cover.style.display!="none")cover.style.display=ad.style.display;if(parseInt(cover.style.zIndex)<=parseInt(ad.style.zIndex)){cover.style.zIndex=parseInt(ad.style.zIndex)+1;this.UpdateHighestKnownZIndex(cover.style.zIndex);}}},WatchForGrazeRegions:function(){for(var i=0,length=document.body.childNodes.length;i<length;i++){var el=document.body.childNodes[i];var id=el.id;if(el.id&&el.id.length>12&&el.id.substr(0,13)=="oggiPlayerDiv"&&el.id.indexOf("graze_cover")==-1){this.AddCoverIfMissing(el,id);this.KeepCoversInPlace(id);}}
var elements=this.GetAdElements();for(var i=0,length=elements.length;i<length;i++){var el=elements[i];var id=el.id;if(el.className&&el.className=='prWrap'){if(!el.id){id='expandable_'+new Date().getTime()+Math.floor(Math.random()*10000);el.id=id;}else{id=el.id;}
this.AddPointrollCoverIfMissing(el,id);this.KeepCoversInPlace(id);}}
setTimeout(this.WatchForGrazeRegions.bind(this),this.MonitorLoop);},GetAdElements:function(){var ad,elements=[],element,possibleads=['ad_frame_leader','ad_frame_box','ad_frame_sky','ad_frame_sky_r','ad_frame_half_page'];for(var i=0;i<possibleads.length;i++){ad=document.getElementById(possibleads[i]);if(ad){for(var j=0,length=ad.parentNode.childNodes.length;j<length;j++){element=ad.parentNode.childNodes[j];if(element&&typeof element.tagName!='undefined'&&element.tagName!='IFRAME'){elements.push(element);}}}}
return elements;}}
var _GCM=GrazeCoverManager;
			AUTOCORE_SELF_CHECK = null;
		
			// File : /okcontent/js/InstantEvents.js
			AUTOCORE_SELF_CHECK = "/okcontent/js/InstantEvents.js";
			
var InstantEventsImplementation=Class.create({m_service_name:"/instantevents",m_comet_iframe_prefix_min:1,m_comet_iframe_prefix_max:12,m_comet_retry_if_all_prefixes_taken:5,m_max_server_reply_time:70,m_safety_throttle_seconds:5,m_seconds_to_consider_new:5,m_seconds_to_stay_online:1800,m_min_wait_after_cb_fail:10,m_max_wait_after_cb_fail:30,m_odds_of_posting_self_timer:0.1,m_message_age_before_considered_archive:3600,m_emergency_reopen_every:40000,m_emergency_reopen_timeout:null,m_optional_params:{},m_is_a_popup:false,m_partner_screenname:"",m_script_obj_id:"instant_events_script_"+Math.random(),m_comet_iframe_prefix:-1,m_script_obj:null,m_destination_div:false,m_last_connection:false,m_comet_iframe_suffix:"",m_last_server_gmt_sync:0,m_last_server_seqid_sync:0,m_last_user_activity:0,m_pending_online_checks:[],m_has_done_initial_online_checks:false,m_send_timing_queue:{},m_turnedon:false,m_has_had_emergency_restart:false,m_is_first_e_r_attempt:true,m_num_throttle_hits:0,m_last_json_replies:[],invoke:function(destination_div,optional_params){if(optional_params.off){this.m_turnedon=false;}
else{this.m_turnedon=true;}
if(optional_params){this.m_optional_params=optional_params;}
if(this.m_optional_params["popup"]&&this.m_optional_params["partner_screenname"]){this.m_is_a_popup=true;this.m_partner_screenname=this.m_optional_params["partner_screenname"];document.title='Chat with '+this.m_optional_params["partner_screenname"]+' | OkCupid';}
var i=0;this.setCometIFrameSuffix();this.m_last_user_activity=new Date();this.m_destination_div=destination_div;ImUiManager.invoke(destination_div,this.m_optional_params);EventUiManager.invoke(destination_div,this.m_optional_params);this.performOnlineCheckNow();this.openConnection(true,false);if(this.m_is_a_popup)
this.openAnImWindow(this.m_partner_screenname,optional_params);},setCometIFrameSuffix:function(){if(window.location.port==2000){this.m_comet_iframe_suffix=".www.okcupid.com/instantevents";}
else if(window.location.port==900){this.m_comet_iframe_suffix=".instant.okcupid.com:900/instantevents";}
else{this.m_comet_iframe_suffix=".instant.okcupid.com/instantevents";}},getAPrefixLock:function(){this.m_comet_iframe_prefix=-1;var i=this.m_comet_iframe_prefix_min-1;while(this.m_comet_iframe_prefix==-1&&i<this.m_comet_iframe_prefix_max){i++;var x=NanoCookie.get('iframe_prefix_lock_'+i);if(!x){NanoCookie.set('iframe_prefix_lock_'+i,'1',{ms:1000*this.m_max_server_reply_time});this.m_comet_iframe_prefix=i;}}},clearPrefixLock:function(){NanoCookie.set('iframe_prefix_lock_'+this.m_comet_iframe_prefix,"1",{ms:1000});this.m_comet_iframe_prefix=-1;},openConnection:function(is_initial,bypass_throttle){var d=new Date();var time_left=this.m_safety_throttle_seconds*1000-(d-this.m_last_connection);if(this.secondsSinceLastUserActivity()>this.m_seconds_to_stay_online){if(this.m_emergency_reopen_timeout){clearTimeout(this.m_emergency_reopen_timeout);this.m_is_first_e_r_attempt=false;}
setTimeout("InstantEvents.openConnection(false,false);",2000);return;}
if(time_left>0&&!bypass_throttle){this.m_num_throttle_hits++;util.updateStats("instant - ui - throttle hit",1,"counter","keqxuxeCzuhEO6X8szEnkyi284s=");if(this.m_has_had_emergency_restart)
util.updateStats("instant - ui - throttle hit after e.r.",1,"counter","IRLVMdV/VQinEH6jk1smZQO6VkA=");if(this.m_num_throttle_hits==1)
util.updateStats("instant - ui - throttle hit - count 1",1,"counter","ZotCHsSXQiZZ8mUAdr58G4h/Y48=");if(this.m_num_throttle_hits==2)
util.updateStats("instant - ui - throttle hit - count 2",1,"counter","bLzNmKpeN6Qv5uUbzFEEh51HmXc=");if(this.m_num_throttle_hits==3)
util.updateStats("instant - ui - throttle hit - count 3",1,"counter","6U/aosnJnIG44QFzV8ZeuPv99B4=");if(this.m_num_throttle_hits==4)
util.updateStats("instant - ui - throttle hit - count 4",1,"counter","wyI6ToCdffIFnSmybPen53OcwA4=");if(this.m_num_throttle_hits==5)
util.updateStats("instant - ui - throttle hit - count 5",1,"counter","gYGA+DcFGvrcaiI3HHT5Lo11MCE=");if(this.m_num_throttle_hits==10)
util.updateStats("instant - ui - throttle hit - count 10",1,"counter","5CiIfAzkUMsCMTr2W5lQ4iSVwXY=");setTimeout("InstantEvents.openConnection(false,false);",time_left+250);return;}
this.getAPrefixLock();if(this.m_comet_iframe_prefix==-1){setTimeout("InstantEvents.openConnection(false,false);",this.m_comet_retry_if_all_prefixes_taken*1000);if(this.m_emergency_reopen_timeout){clearTimeout(this.m_emergency_reopen_timeout);this.m_is_first_e_r_attempt=false;}
return;}
this.m_last_connection=new Date();if(this.m_emergency_reopen_timeout){clearTimeout(this.m_emergency_reopen_timeout);this.m_is_first_e_r_attempt=false;}
this.m_emergency_reopen_timeout=setTimeout("InstantEvents.emergencyReopenConnection();",this.m_emergency_reopen_every);var final_src=document.location.protocol+'//'+this.m_comet_iframe_prefix+this.m_comet_iframe_suffix+'?random='+Math.random();if(!is_initial){final_src+="&server_seqid="+this.m_last_server_seqid_sync;final_src+="&server_gmt="+this.m_last_server_gmt_sync;setTimeout('document.body.removeChild($("'+this.m_script_obj_id+'"));',2000);}
this.m_script_obj_id='instant_events_script_'+Math.random();this.m_script_obj=IFrameInsertedAt(document.body);this.m_script_obj.setAttribute("id",this.m_script_obj_id);this.m_script_tag=this.m_script_obj.doc.createElement("script");this.m_script_tag.src=final_src;this.m_script_tag.type="text/javascript";setTimeout("InstantEvents.m_script_obj.doc.body.appendChild(InstantEvents.m_script_tag)",500);$(this.m_script_obj_id).style.display="none";},emergencyReopenConnection:function(){var d=new Date();util.updateStats("instant - ui - emergency restart",1,"counter","GZPpF7XECZ2Kv9Vz1sVeN2GcwGg=");if(this.m_is_first_e_r_attempt)
util.updateStats("instant - ui - emergency restart - on first",1,"counter","yp1SFIPrKRjS1W9qXkQHTZjSCuI=");new Ajax.Request("/why",{method:"get",parameters:{"instanteventswatch":1,"openconnections":NanoCookie.findRegExp(/iframe_prefix_lock_.*/).length,"reqtime":d.getTime()/1000}});this.m_has_had_emergency_restart=true;this.openConnection(false,true);},recordResponseForDebugging:function(response){var r_json=Object.toJSON(response);this.m_last_json_replies.push(r_json);if(this.m_last_json_replies.length>5)
this.m_last_json_replies=this.m_last_json_replies.splice(1,this.m_last_json_replies.length-1);},openConnection_cb:function(response){this.clearPrefixLock();if(response.server_gmt){this.m_last_server_gmt_sync=response.server_gmt;}
if(response.server_seqid&&response.server_seqid>0){this.m_last_server_seqid_sync=response.server_seqid;}
if(response.events&&response.events.length){setTimeout("InstantEvents.openConnection(false,true)",Math.random()*1000);for(var i=0;i<response.events.length;i++){if(response.events[i].type=="im"&&this.m_turnedon){var partner_screenname;if(response.events[i].from)
partner_screenname=response.events[i].from;else
partner_screenname=response.events[i].to;if(!this.m_is_a_popup||partner_screenname.toLowerCase()==this.m_partner_screenname.toLowerCase()){if(!ImUiManager.m_open_chats[partner_screenname.toLowerCase()]){for(var j=0;j<response.people.length;j++){if(response.people[j].screenname.toLowerCase()==partner_screenname.toLowerCase()){ImUiManager.addAnOpeningMessage(response.people[j]);}}}
ImUiManager.addAMessage(response.events[i],this.m_last_server_gmt_sync-response.events[i].server_gmt);}}else{for(var j=0;j<response.people.length;j++){if(typeof response.people[j].screenname!='undefined')
var people_from=response.people[j].screenname.toLowerCase();if(typeof response.events[i].from!='undefined')
var events_from=response.events[i].from.toLowerCase();if(people_from&&events_from&&people_from==events_from){var is_signoff_event=(response.events[i].type=="orbit"&&response.events[i].event_id=="11"||response.events[i].type=="orbit_user_signoff");if(is_signoff_event&&!ImUiManager.m_open_chats[events_from]){}
else{EventUiManager.update(response.people[j],response.events[i]);break;}}}}}
if(response.people){for(var i=0;i<response.people.length;i++){if(!this.m_is_a_popup||response.people[i].screenname.toLowerCase()==this.m_partner_screenname.toLowerCase()){ImUiManager.maintainScrollTop(response.people[i].screenname);}}}
if(!ImUiManager.m_is_a_popup)ImUiManager.giveSomethingFocus();}
else if(response.not_logged_in){this.m_turnedon=false;}
else{setTimeout("InstantEvents.openConnection(false,false)",Math.random()*1000);}},endConnections:function(){this.clearPrefixLock();},openAnImWindow:function(partner_screenname,optional_params){ImUiManager.enableIM();var already_open=false;optional_params=optional_params||{};if(ImUiManager.m_open_chats[partner_screenname.toLowerCase()]){already_open=true;}
optional_params.set_state="expanded";ImUiManager.addAChat(partner_screenname,optional_params);if(!already_open){ImUiManager.getUserInfoForNewIm(partner_screenname);}
var messageid=ImUiManager.m_open_chats[partner_screenname.toLowerCase()].m_window_id;if(!ImUiManager.m_is_a_popup){ImUiManager.removeFocus();ImUiManager.m_open_chats[partner_screenname.toLowerCase()].addFocus();}
$('message_'+messageid).focus();},sendAnIm:function(partner_screenname,msg){var random_id=Math.round(Math.random()*2000000000);var strategy=2;this.updateLastUserActivity();ImUiManager.enableIM();ImUiManager.loseAttention(partner_screenname);this.m_send_timing_queue[random_id]=new Date();new Ajax.Request(this.m_service_name,{method:"post",parameters:{send:1,attempt:1,rid:random_id,recipient:partner_screenname,topic:false,body:msg,rand:Math.random()},onSuccess:InstantEvents.sendAnIm_cb.bindAsEventListener(this,partner_screenname,random_id,1,strategy),onFailure:InstantEvents.sendAnIm_cb_fail.bindAsEventListener(this)});if(strategy==2){setTimeout(this.sendAnImCopy.bind(this,partner_screenname,msg,random_id,strategy),1000);}},sendAnImCopy:function(partner_screenname,msg,random_id,strategy){if(this.m_send_timing_queue[random_id]){new Ajax.Request(this.m_service_name,{method:"post",parameters:{send:1,attempt:2,rid:random_id,recipient:partner_screenname,body:msg,rand:Math.random()},onSuccess:InstantEvents.sendAnIm_cb.bindAsEventListener(this,partner_screenname,random_id,2,strategy),onFailure:InstantEvents.sendAnIm_cb_fail.bindAsEventListener(this)});}},sendAnIm_cb:function(transport,partner_screenname,random_id,attempt,strategy){if(this.m_send_timing_queue[random_id]){var send_time=this.m_send_timing_queue[random_id];this.m_send_timing_queue[random_id]=null;var d=new Date();var ms=d.getTime()-send_time.getTime();if(Math.random()<this.m_odds_of_posting_self_timer){new Ajax.Request(this.m_service_name,{method:"get",parameters:{self_timer:1,milliseconds:ms,attempt:attempt,strategy:strategy}});}}
var response=transport.responseText.evalJSON();if(response.message_sent!=1||response.reason=='nag'){var key_pass={p_screenname:partner_screenname}
switch(response.reason){case"recip_not_online":ImUiManager.addASystemMessage(partner_screenname,util.jogf('<strong>%p_screenname</strong> signed out. We will deliver your message to their mailbox if they do not return in the next few minutes.',key_pass));break;case"im_not_ok":ImUiManager.addASystemMessage(partner_screenname,util.jogf('<strong>%p_screenname</strong> signed out. We will deliver your message to their mailbox if they do not return in the next few minutes.',key_pass));break;case"im_self":ImUiManager.addASystemMessage(partner_screenname,util.jogf('You&rsquo;re great company, but isn&rsquo;t talking to yourself a little&hellip; crazy?',key_pass));break;case"recip_im_off":ImUiManager.addASystemMessage(partner_screenname,util.jogf('<strong>%p_screenname</strong> signed out. We will deliver your message to their mailbox if they do not return in the next few minutes.',key_pass));break;case"nag":ImUiManager.addAStaffRobotMessage(partner_screenname,'nag');break;}}},sendAnIm_cb_fail:function(transport){alert('Send failed! Let us know about it at www.okcupid.com/feedback');},checkOnline:function(params){var key;this.m_pending_online_checks.push(params);if(this.m_has_done_initial_online_checks){this.performOnlineCheckNow();}},performOnlineCheckNow:function(){this.m_has_done_initial_online_checks=true;if(this.m_pending_online_checks.length==0){return;}
var params={is_online:1,rand:Math.random()};var added_already={};var username_list="";var userid_list="";for(var i=0;i<this.m_pending_online_checks.length;i++){var check=this.m_pending_online_checks[i];if(check.username&&!added_already[check.username]){if(username_list!="")
username_list+=",";username_list+=check.username;added_already[check.username]=true;}
else if(check.userid&&!added_already[check.userid]){if(userid_list!="")
userid_list+=","
userid_list+=check.userid;added_already[check.userid]=true;}}
if(username_list!="")
params["usernames"]=username_list;if(userid_list!="")
params["userids"]=userid_list;new Ajax.Request(this.m_service_name,{method:"post",parameters:params,onSuccess:InstantEvents.performOnlineCheck_cb.bindAsEventListener(this),onFailure:InstantEvents.performOnlineCheck_cb_fail.bindAsEventListener(this)});},performOnlineCheck_cb:function(transport){var result=transport.responseText.evalJSON();for(var j=0;j<this.m_pending_online_checks.length;j++){found_yet=false;var check=this.m_pending_online_checks[j];for(var i=0;i<result.length&&!found_yet;i++){if((check.username&&check.username.toLowerCase()==result[i].screenname.toLowerCase())||(check.userid==result[i].userid)){found_yet=true;if(result[i].open_connection){if(check.hide){$(check.hide).style.display="none";}
if(check.show){$(check.show).style.display="";}}
if(check.cb){check.cb(result[i]);}}}
if(found_yet==false){check.cb({screenname:check.username.toLowerCase(),userid:check.userid,open_connection:false,im_ok:false,im_not_ok:true});}}
this.m_pending_online_checks=[];},blockImAjax:function(screenname){new Ajax.Request(this.m_service_name,{method:"get",parameters:{im_block:1,target_screenname:screenname}});},performOnlineCheck_cb_fail:function(){alert("Failed to check online.");},updateLastUserActivity:function(){this.m_last_user_activity=new Date();},secondsSinceLastUserActivity:function(){var d=new Date();return(d.getTime()-this.m_last_user_activity.getTime())/1000;},activateIM:function(){if(!this.m_turnedon){new Ajax.Request("/instantevents",{parameters:{turn_im_on:1}});this.m_turnedon=true;this.performOnlineCheckNow();this.openConnection(false,false);}},deactivateIM:function(){if(this.m_turnedon){this.m_turnedon=false;new Ajax.Request("/instantevents",{parameters:{turn_im_off:1}});}}});var ImUiManagerImplementation=Class.create({m_optional_params:{},m_is_a_popup:false,m_partner_screenname:"",m_service_name:"/instantevents",m_open_chats:{},m_destination_div:false,m_window_flashing_message:"",m_window_flashing_rate:1000,m_window_flashing_interval:null,m_original_document_title:"",m_new_im_flashing:false,m_close_action:function(){},invoke:function(destination_div,optional_params){this.m_optional_params=optional_params;this.m_destination_div=destination_div;if(this.m_optional_params["popup"]&&this.m_optional_params["partner_screenname"]){this.m_is_a_popup=true;this.m_partner_screenname=this.m_optional_params["partner_screenname"];Event.observe(window,"beforeunload",this.m_close_action);}
else{setInterval(this.watchForPopouts.bind(this),1000);}
this.createPreferencesTab();},numVisibleChats:function(){var res=0;for(chat in this.m_open_chats){if(this.m_open_chats[chat].m_state!="hidden"){res++;}}
return res;},doImBlock:function(partner_screenname){if(this.m_open_chats[partner_screenname.toLowerCase()]){this.m_open_chats[partner_screenname.toLowerCase()].doBlock();}},createPreferencesTab:function(){var im_state=InstantEvents.m_turnedon?'':' unfocused';var selected=InstantEvents.m_turnedon?'on':'off';var on='',off='';if(selected=='on'){on=' class="activated"';}else{off=' class="activated"';}
var html=''
+'<div class="im_prefs_tab'+im_state+'" id="im_prefs">'
+'<div class="im_toggler"></div>'
+'<div class="im_settings">'
+'<a href="#" id="im_on"'+on+' onclick="return false;"><span></span> On</a>'
+'<a href="#" id="im_off"'+off+' onclick="return false;"><span></span> Off</a>'
+'</div>'
+'</div>';Element.insert(this.m_destination_div,{"bottom":html});$('im_prefs').observe('mouseover',this.openPreferencesTab);$('im_prefs').observe('mouseout',this.closePreferencesTab);$('im_on').observe('click',this.selectPreference.bind(this));$('im_off').observe('click',this.selectPreference.bind(this));},hoverPreference:function(event){var element=$(event.target);if(event.target.tagName!='A'){if(element.up('a'))element=element.up('a');else return;}
if(event.target.id=='im_off'){$('im_on').removeClassName('activated');$('im_off').addClassName('activated');}else{$('im_on').addClassName('activated');$('im_off').removeClassName('activated');}},restorePreference:function(){var settings=$('im_prefs').down('div.im_settings');if(oldstate=='off'){$('im_on').removeClassName('activated');$('im_off').addClassName('activated');}else{$('im_on').addClassName('activated');$('im_off').removeClassName('activated');}},selectPreference:function(event){Event.stop(event);var settings=$('im_prefs').down('div.im_settings');var element=$(event.target);if(event.target.tagName!='A'){if(element.up('a'))element=element.up('a');else return;}
if(element.hasClassName('activated'))return;if(element.id=='im_on'){this.enableIM();}else{this.disableIM();}},enableIM:function(){if($('im_off')&&$('im_off').hasClassName('activated')){$('im_prefs').removeClassName('unfocused');$('im_on').addClassName('activated');$('im_off').removeClassName('activated');for(var i in this.m_open_chats){$('im_container_'+this.m_open_chats[i].m_window_id).removeClassName('invisible');}
InstantEvents.activateIM();}},disableIM:function(){if($('im_on')&&$('im_on').hasClassName('activated')){$('im_prefs').addClassName('unfocused');$('im_on').removeClassName('activated');$('im_off').addClassName('activated');for(var i in this.m_open_chats){$('im_container_'+this.m_open_chats[i].m_window_id).addClassName('invisible');}
InstantEvents.deactivateIM();}},openPreferencesTab:function(){$('im_prefs').addClassName('expanded');},closePreferencesTab:function(){$('im_prefs').removeClassName('expanded');},removeFocus:function(){for(chat in this.m_open_chats){this.m_open_chats[chat].removeFocus();}},isSomethingActive:function(){var active=0,c,chat;for(c in this.m_open_chats){chat=this.m_open_chats[c];if(!$('im_container_'+chat.m_window_id).hasClassName('unfocused')){this.removeFocus();chat.addFocus();return chat.m_window_id;}}
return active;},giveSomethingFocus:function(){if(this.isSomethingActive())return;for(chat in this.m_open_chats){if(this.m_open_chats[chat].m_state=='expanded'){$('im_container_'+this.m_open_chats[chat].m_window_id).removeClassName('unfocused');return;}}},getOpenScreenNames:function(){var res=new Array();for(chat in this.m_open_chats){res.push(this.m_open_chats[chat].m_partner_screenname);}
return res;},addAChat:function(partner_screenname,optional_params){this.addAChatIfMissing(partner_screenname,optional_params);if(optional_params&&optional_params.set_state){this.m_open_chats[partner_screenname.toLowerCase()].setState(optional_params.set_state);}
this.adjustWindowWidths();},addAChatIfMissing:function(partner_screenname,optional_params){if(!this.m_open_chats[partner_screenname.toLowerCase()]){this.m_open_chats[partner_screenname.toLowerCase()]=new ImWindow(this.m_destination_div,partner_screenname,optional_params);}
this.adjustWindowWidths();},removeAChat:function(partner_screenname){if(this.m_open_chats[partner_screenname.toLowerCase()]){this.m_open_chats[partner_screenname.toLowerCase()].unDraw();this.m_open_chats[partner_screenname.toLowerCase()]=false;}},maintainScrollTop:function(partner_screenname){var screen_lower=partner_screenname.toLowerCase();if(this.m_open_chats[screen_lower]){this.m_open_chats[screen_lower].maintainScrollTop();}},getUserInfoForNewIm:function(partner_screenname){new Ajax.Request("/userinfo",{method:"get",parameters:{u:partner_screenname,thumb:true},onSuccess:ImUiManager.getUserInfoForNewIm_cb.bindAsEventListener(this)});},getUserInfoForNewIm_cb:function(transport){var info=transport.responseText.evalJSON();info.screenname=info.target;ImUiManager.addAnOpeningMessage(info);},addAnOpeningMessage:function(im_person,optional_params){this.addAChatIfMissing(im_person.screenname,optional_params);this.m_open_chats[im_person.screenname.toLowerCase()].addAnOpeningMessage(im_person,optional_params);this.adjustWindowWidths();},addAMessage:function(im_event,message_age_in_seconds){var partner_screenname=im_event.to?im_event.to:im_event.from;var c=NanoCookie.get("im_state_"+partner_screenname.toLowerCase());this.addAChatIfMissing(partner_screenname);this.m_open_chats[partner_screenname.toLowerCase()].addAMessage(im_event.contents,im_event.to?true:false,im_event.server_gmt);if(im_event.from&&message_age_in_seconds<InstantEvents.m_seconds_to_consider_new){this.drawAttention(partner_screenname);}
if(message_age_in_seconds<InstantEvents.m_seconds_to_consider_new)
this.adjustWindowWidths();},addASystemMessage:function(partner_screenname,text){this.addAChatIfMissing(partner_screenname);this.m_open_chats[partner_screenname.toLowerCase()].addASystemMessage(text);},addAStaffRobotMessage:function(partner_screenname,text){this.addAChatIfMissing(partner_screenname);this.m_open_chats[partner_screenname.toLowerCase()].addAStaffRobotMessage(text);},startFlashingWindow:function(){if(this.m_original_document_title==""){this.m_original_document_title=document.title;}
this.stopFlashingWindow(false);document.title=this.m_window_flashing_message;this.flashingWindowLoop();this.m_window_flashing_interval=setInterval(this.flashingWindowLoop.bindAsEventListener(this),this.m_window_flashing_rate);},stopFlashingWindow:function(notify_others){if(this.m_window_flashing_interval){clearInterval(this.m_window_flashing_interval);}
this.m_window_flashing_interval=null;if(this.m_original_document_title!=""){document.title=this.m_original_document_title;}
if(notify_others){if(ImUiManager.m_is_a_popup){NanoCookie.set('stop_flashing_'+this.m_partner_screenname.replace(/[^a-zA-Z0-9]+/g,''),'1',{ms:3000});}else{NanoCookie.set("stop_flashing","1",{ms:3000});}}},flashingWindowLoop:function(){if(document.title==this.m_original_document_title)
document.title=this.m_window_flashing_message;else
document.title=this.m_original_document_title;if(ImUiManager.m_is_a_popup){var x=NanoCookie.get('stop_flashing_'+this.m_partner_screenname.replace(/[^a-zA-Z0-9]+/g,''));}else{var x=NanoCookie.get("stop_flashing");}
if(x){this.stopFlashingWindow(false);}},drawAttention:function(partner_screenname){this.addAChatIfMissing(partner_screenname);this.m_open_chats[partner_screenname.toLowerCase()].drawAttention();this.m_window_flashing_message=partner_screenname+' says...'
this.startFlashingWindow();},flashAttention:function(partner_screenname){this.m_open_chats[partner_screenname.toLowerCase()].flashAttention();},flashPopup:function(partner_screenname){this.m_open_chats[partner_screenname.toLowerCase()].flashPopup();},loseAttention:function(partner_screenname){this.m_open_chats[partner_screenname.toLowerCase()].loseAttention();this.stopFlashingWindow(true);},expandChat:function(partner_screenname){this.addAChatIfMissing(partner_screenname);this.m_open_chats[partner_screenname.toLowerCase()].expand();this.maintainScrollTop(partner_screenname);},collapseChat:function(partner_screenname){this.addAChatIfMissing(partner_screenname);this.m_open_chats[partner_screenname.toLowerCase()].collapse();},hideChat:function(partner_screenname){new Ajax.Request("/instantevents",{method:"get",parameters:{"im.window_closed":1}});this.addAChatIfMissing(partner_screenname);this.m_open_chats[partner_screenname.toLowerCase()].hide();this.adjustWindowWidths();},popChat:function(partner_screenname){this.addAChatIfMissing(partner_screenname);var w_width=(typeof(ad_popout_chat_display)!='undefined'&&ad_popout_chat_display==1)?440:375;var w_height=(typeof(ad_popout_chat_display)!='undefined'&&ad_popout_chat_display==1)?470:450;var add_cgi_pass="";if(Branding.on){check=$("im_container_"+this.m_open_chats[partner_screenname.toLowerCase()].m_window_id).down();brandname=Branding.check_for_brand(check);if(brandname){add_cgi_pass="&branded="+brandname;}}
var w=window.open("/instantevents/popup.html?partner_screenname="+partner_screenname+add_cgi_pass,partner_screenname.toLowerCase(),"height="+w_height+",width="+w_width+",scrollbars=1,location=0,resizable=1,status=0");if(w){w.focus();this.m_open_chats[partner_screenname.toLowerCase()].popChat();this.adjustWindowWidths();}
else{alert("You have a popup blocker that is preventing pop-out IM windows.");}},watchForPopouts:function(){for(chat in this.m_open_chats){var partner_tolower=this.m_open_chats[chat].m_partner_screenname.toLowerCase();var c=NanoCookie.get("unpop_"+partner_tolower);if(c){if(c=="expand")
ImUiManager.expandChat(partner_tolower);else if(c=="hide")
ImUiManager.hideChat(partner_tolower);else if(c=="collapse")
ImUiManager.collapseChat(partner_tolower);else
alert("popping back in to an unknown state.");}
else{c=NanoCookie.get("im_state_"+partner_tolower);if(c&&c=="popped"){this.m_open_chats[chat].popChat();}}}},maintainPopupState:function(partner_screenname){NanoCookie.set('im_state_'+this.m_partner_screenname.toLowerCase(),"popped",{ms:3000});},unpopAndChangeState:function(partner_screenname,new_state){NanoCookie.set("unpop_"+partner_screenname.toLowerCase(),new_state,{ms:3000});Event.stopObserving(window,"beforeunload",this.m_close_action);window.close();},catchKeyStroke:function(e,partner_screenname){if(this.m_open_chats[partner_screenname.toLowerCase()].m_has_attention){this.loseAttention(partner_screenname);this.m_open_chats[partner_screenname.toLowerCase()].addFocus();}
if(partner_screenname==false){if(e.keyCode==13)this.tryNewIm();}
else if(e.keyCode==13){this.sendTo(partner_screenname);}
if(!ImUiManager.m_is_a_popup){this.m_open_chats[partner_screenname.toLowerCase()].resizeInput();}},catchBlur:function(e,partner_screenname){var id=this.m_open_chats[partner_screenname.toLowerCase()].m_window_id;$($('message_'+id).parentElement).removeClassName('focused');},catchFocus:function(e,partner_screenname){var chat=this.m_open_chats[partner_screenname.toLowerCase()];if(!chat)return;var id=chat.m_window_id;if(chat.m_has_attention){this.loseAttention(partner_screenname);this.m_open_chats[partner_screenname.toLowerCase()].addFocus();}
$($('message_'+id).parentElement).addClassName('focused');},catchContainerClick:function(e,partner_screenname){if(this.m_open_chats[partner_screenname.toLowerCase()].m_has_attention){this.loseAttention(partner_screenname);}
if(!$(e.target).hasClassName('close')&&!$(e.target).hasClassName('pop')&&!$(e.target).hasClassName('collapse')){this.m_open_chats[partner_screenname.toLowerCase()].addFocus();}},sendTo:function(partner_screenname){var im_window=this.m_open_chats[partner_screenname.toLowerCase()];if(im_window){var msg=im_window.getTypedMessage();msg=msg.replace("\n"," ");msg=msg.replace("\r"," ");msg=msg.replace("\t"," ");if(msg&&msg.length>0){InstantEvents.sendAnIm(partner_screenname,msg);}
im_window.clearTypedMessage();}
else{alert("No open IM to that person! Weird! Let us know at www.okcupid.com/feedback");return;}},adjustWindowWidths:function(){if(this.numVisibleChats()>3)
$(this.m_destination_div).removeClassName('large');else
$(this.m_destination_div).addClassName('large');}});var EventUiManagerImplementation=Class.create({m_destination_div:false,m_optional_params:{},m_event_div:"event_display",m_event_num:0,m_event_count:0,m_event_max:2,m_event_timer:null,invoke:function(destination_div,optional_params){var c=NanoCookie.get('display_events');this.m_destination_div=destination_div;if(optional_params)
this.m_optional_params=optional_params;},createEventDisplay:function(){this.m_event_count=0;var res='<div id="'+this.m_event_div+'_container">';res+=' <div id="'+this.m_event_div+'" onMouseOver="EventUiManager.mouseover();" onMouseOut="EventUiManager.mouseout();">'
+'  <a href="#" class="close" title="Close" onClick="EventUiManager.close(); return false;"></a>'
+'  <div id="'+this.m_event_div+'_body"></div>'
+' </div>'
+'</div>';Element.insert(this.m_destination_div,{"top":res});},update:function(person,event){var res='',image='',image_title='',sname=person.screenname,his_her=person.gender=='M'?'his':'her';var info=this.getType(event,his_her);if(info.skip_event)return;if(person.thumb.length>0){var image_tag='<img src="http://akcdn.okccdn.com/php/load_okc_image.php/images/60x60/60x60/'+person.thumb+'" height="40" width="40" />';}else{var image_tag='<img src="http://akcdn.okccdn.com/media/img/user/d_60.png" height="40" width="40" />';}
var new_event_style=(this.m_event_count>=this.m_event_max?' style="display: none;"':'');res+='<div id="event_wrapper_'+this.m_event_num+'"'+new_event_style+' class="orbit_event">';if(event.type!='looks_vote'){res+='<a href="/profile/'+person.screenname+'" class="thumb">'+image_tag+'</a>';}
res+='<div class="info">'
+'<div class="user"><a href="/profile/'+sname+'">'+sname+'</a></div>'
+'<div class="action">'+info.string+'</div>'
+'</div';res+='</div>';if(!$(this.m_event_div+'_container')){this.createEventDisplay();$(this.m_event_div+'_body').update(res);this.m_event_count++;}
else{clearTimeout(this.m_event_timer);if(this.m_event_count>=this.m_event_max){$(this.m_event_div+'_body').innerHTML+=res;$('event_wrapper_'+(this.m_event_num-this.m_event_count)).hide();$('event_wrapper_'+this.m_event_num).show();}else{$(this.m_event_div+'_body').innerHTML+=res;this.m_event_count++;}}
this.m_event_num++;this.m_event_timer=setTimeout("$(EventUiManager.m_event_div + '_container').remove();",12000);},mouseover:function(){clearTimeout(this.m_event_timer);},mouseout:function(){this.m_event_timer=setTimeout("$(EventUiManager.m_event_div + '_container').remove();",12000);},close:function(){$(this.m_event_div+'_container').remove();},getType:function(event,his_her){var type,types={'msg_notify':{text:'Sent you a message!',stat:'instant events - orbit notice - sent you a message',hash:'b758qMsjuyd9attfg3TyPzFqnd4='},'stalk':{text:"Just visited your profile!",stat:"instant events - orbit notice - you've been stalked",hash:'2sESFk0RMWcM2KvBrfARSA5c3q4='},'looks_vote':{text:'Just rated you in <a href="/quickmatch">Quickmatch</a>!',stat:"instant events - orbit notice - rated you",hash:'jeTns0XTD16gashWILzr5eFVQ60='},'wiki_edit':{text:'Made a wiki edit to your profile!',stat:"instant events - orbit notice - made a wiki edit to your profile",hash:'Irby1kijEtGlbQ9WT+Bej2SHJXY='},'orbit_going_public':{text:'Answered a question publicly!',stat:"instant events - orbit notice - going public",hash:'CFKpdS8Sjo/ew05yJo4UADqmFxM='},'orbit_q_note':{text:'Attached a note to a public question answer!',stat:"instant events - orbit notice - question note",hash:'mmNK/G02VZEvRzW6tdu15Kn+6Iw='},'orbit_profile_updated':{text:'Edited '+his_her+' profile!',stat:"instant events - orbit notice - edited profile",hash:'zfturXyYvJJWpy2V0pAx6Xbu2ZE='},'orbit_display_status_changed':{text:'Changed '+his_her+' status from '+event.event_arg1+' to '+event.event_arg2,stat:"instant events - orbit notice - changed status",hash:'BVLeDQXWJIbbLayLTxjnON2auIg='},'orbit_test_take':{text:'Took <a href="'+event.event_arg1+'">'+event.event_arg2+'</a> and scored <a href="'+event.event_arg3+'">'+event.event_arg4+'</a>!',stat:"instant events - orbit notice - took test",hash:'FXuWaNekr6dIl1mBN/dXaOkzB74='},'orbit_nth_question':{text:'Has now answered '+event.event_arg1+' questions!',stat:"instant events - orbit notice - nth question",hash:'tVgOVHxD4pZh60S6T74SbawRMKM='},'orbit_picture_upload':{text:'Uploaded a new photo!',stat:"instant events - orbit notice - photo upload",hash:'TR6fYD1jhJsrPrX5TYksZJPcGRs='},'orbit_psychgame_take':{text:'Played <a href="/psychologist-game">The Psychologist Game</a> and scored '+event.event_arg1+' points, with '+event.event_arg2+' correct answers!',stat:"instant events - orbit notice - psych game",hash:'HMe6dW4DoxNLKq000zJ9DFewKYQ='},'orbit_user_signon':{text:'Signed in!',stat:"instant events - orbit notice - logged in",hash:'HoZ17v6J7ctH2lMJ7Y/s+JGtw2w='},'orbit_user_signoff':{text:'Signed out.',stat:"instant events - orbit notice - logged out",hash:'zdV8K0lCCsTpgBNcbUZ8+Spm97c='},'broadcast':{text:'<a href="/about/okcupid">OkCupid</a> just did something awesome!',stat:"instant events - orbit notice - did something awesome",hash:'5mKfUeGHc+TS9JeHOJBHyvuQvi4='},'journal_comment':{text:"Left a comment in your journal!",stat:"instant events - orbit notice - commented in your journal",hash:'MI7NdIer+XP0iweaqDIvRIWjrmM=',skip_event:true},'orbit_journal_post':{text:'just posted a journal entry!',stat:"instant events - orbit notice - posted in their journal",hash:'RcwAUVoptvYPkTaPEKTXKSRla2s=',skip_event:true},'orbit_board_comment':{text:'left a <a href="'+event.event_arg1+'">comment</a> on <a href="/profile/'+event.event_arg2+'">'+event.event_arg2+'\'s</a> journal post!',stat:"instant events - orbit notice - journal comment",hash:'8bKTuhn9GkF2yiLtd7TbUgfcKvc=',skip_event:true},'orbit_forum_comment':{text:'left a <a href="/forum?tid='+event.event_arg1+'#c-'+event.event_arg2+'">comment</a> in the forum topic "'+event.event_arg3+'"!',stat:"instant events - orbit notice - forum comment",hash:'zIt8EaUkh1u/MtEyjIVH1yaMU8s=',skip_event:true},'orbit_forum_post':{text:'made a post titled <a href="/forum?tid='+event.event_arg1+'">"'+event.event_arg2+'"</a> in the forums!',stat:"instant events - orbit notice - forum post",hash:'/jd1jZfs7+FGWFyvuRgMr+yssJM=',skip_event:true}}
type=types[event.type];if(!type)
return{skip_event:true};if(type.stat&&type.hash)
util.updateStats(type.stat,1,'counter',type.hash);return{string:type.text,skip_event:type.skip_event};}});var ImWindow=Class.create({m_state:'expanded',m_partner_screenname:'',m_window_id:0,m_destination_div:false,m_has_attention:false,m_click_tracker:null,m_last_msg_time:0,initialize:function(destination_div,partner_screenname,optional_params){this.m_destination_div=destination_div;this.optional_params=optional_params||{};$(this.m_destination_div).style.display="";this.m_partner_screenname=partner_screenname;this.m_state=this.getAndRefreshStartState();this.m_window_id=Math.random()*1000000000;this.draw();},getAndRefreshStartState:function(){var state=NanoCookie.get('im_state_'+this.m_partner_screenname.toLowerCase());if(state){this.m_state=state;}
else{this.m_state='expanded';}
this.writeStateToCookie();return this.m_state;},writeStateToCookie:function(){NanoCookie.set('im_state_'+this.m_partner_screenname.toLowerCase(),this.m_state,{ms:3599*1000});},addAnOpeningMessage:function(im_person){if(typeof(im_person.sexpref)!='undefined'){im_person.orientation=im_person.sexpref.toUpperCase().charAt(0);}
var gender=(im_person.gender=='M'?"M":"F");var orientation="Straight";if(im_person.orientation=='G')
orientation="Gay";else if(im_person.orientation=='B')
orientation="Bisexual";if(!ImUiManager.m_is_a_popup){var res='<p class="info clearfix">';res+='<a href="/profile/'+im_person.screenname+'">';if(im_person.thumb!='')
res+='<img src="http://akcdn.okccdn.com/php/load_okc_image.php/images/60x60/60x60/'+im_person.thumb+'" height="60" width="60" title="An image of '+im_person.screenname+'" />';else
res+='<img src="http://cdn.okccdn.com/media/img/user/d_60.png" height="60" width="60" title="An image of '+im_person.screenname+'" />';res+='</a>'
+'<span class="user"><a href="/profile/'+im_person.screenname+'">'+im_person.screenname+'</a></span>'
+'<span class="aso">'+im_person.age+' / '+gender+' / '+orientation+'</span>'
+'<span class="location">'+im_person.location+'</span>'
+'</p>';$('im_expanded_contents_'+this.m_window_id).innerHTML=res+$('im_expanded_contents_'+this.m_window_id).innerHTML;}else{var res='<p class="user image"><a href="/profile/'+im_person.screenname+'" target="_blank">';if(im_person.thumb!='')
res+='<img src="http://akcdn.okccdn.com/php/load_okc_image.php/images/60x60/60x60/'+im_person.thumb+'" height="60" width="60" title="An image of '+im_person.screenname+'" />';else
res+='<img src="http://akcdn.okccdn.com/media/img/user/d_60.png" alt="Default user image" width="60" height="60" border="0" title="Default user image" />';res+='</a></p>'
+'<p class="user name"><a href="/profile/'+im_person.screenname+'" target="_blank">'+this.m_partner_screenname+'</a></p>'
+'<p class="user aso">'+im_person.age+' / '+gender+' / '+orientation+'</p>'
+'<p class="user location">'+im_person.location+'</p>';$('info_area').innerHTML+=res;}},addAMessage:function(msg,from_me,msg_gmt){var windowObj=$("im_container_"+this.m_window_id)||$("p_popout_chat");var archive=(InstantEvents.m_last_server_gmt_sync-msg_gmt>InstantEvents.m_message_age_before_considered_archive?' archive':'');var sn=from_me?SCREENNAME:this.m_partner_screenname;var time=new Date(msg_gmt*1000);var res='';try{content=eval('('+msg+')');msg=content.text;}catch(e){msg=msg;}
if(msg.startsWith('/me')){msg='*'+sn+' '+msg.substring(3).stripTags()+'*';}
if(!this.m_last_msg_time||time.getTime()>this.m_last_msg_time.getTime()+60*1000*5){var timestamp=makeSmartDateString(time,IM_PERIODIC_FORMAT);res+='<p class="timestamp">'+timestamp+'</p>';this.m_last_msg_time=time;}
res+='<p class="im '+(from_me?'from_me':'to_me')+archive+'"><span class="wedge"></span>';res+=msg.stripTags();res+='</p>';$('im_expanded_contents_'+this.m_window_id).innerHTML+=res;this.maintainScrollTop();},addASystemMessage:function(msg){var res=""
+'<p class="im from_system">'
+msg.stripTags();+'</p>';$('im_expanded_contents_'+this.m_window_id).innerHTML+=res;this.maintainScrollTop();},addAStaffRobotMessage:function(msg){var res;if(msg=='nag'){switch(Math.floor(Math.random()*5)){case 0:res='Staff Robot here. People respond better to thoughtful messages.  Try that!';break;case 1:res='Hey! You\'ve been sending a lot of messages.  Try lowering quantity and increasing quality to get more responses.';break;case 2:res='Science has proven: thoughtful messages are the most attractive.';break;case 3:res='Try sending fewer users more composed messages.  You might get better responses!';break;case 4:res='Try writing well thought out messages to increase peoples\' tendancy to respond to you.';break;default:}}
msg='<div class="im_from_staffrobot">'+(res||msg)+'</div>';$('im_expanded_contents_'+this.m_window_id).innerHTML+=msg;this.maintainScrollTop();},doBlock:function(){var pass_name=this.m_partner_screenname;var html=pass_name+" has been blocked!";InstantEvents.blockImAjax(this.m_partner_screenname);this.updateBlockPane(html);$('message_'+this.m_window_id).value="blocked";$('message_'+this.m_window_id).setStyle({fontStyle:'italic',fontWeight:'bold',color:'#555'});$('message_'+this.m_window_id).disable();},maintainScrollTop:function(){if(!ImUiManager.m_is_a_popup)
$('im_expanded_contents_'+this.m_window_id).scrollTop=100000000;else
var height=$(document.body).scrollHeight;if(window.scrollTo){window.scrollTo(0,height);}else if(window.scrollBy){window.scrollBy(0,height);}},drawAttention:function(){if(!this.m_has_attention){this.m_has_attention=true;if(this.m_state=="hidden"){this.collapse();}
if(ImUiManager.m_is_a_popup){$(document.body).addClassName('alert');setTimeout("ImUiManager.flashPopup('"+this.m_partner_screenname+"');",ImUiManager.m_window_flashing_rate);}else{$('im_wrapper_'+this.m_window_id).addClassName("alert");setTimeout("ImUiManager.flashAttention('"+this.m_partner_screenname+"');",ImUiManager.m_window_flashing_rate);}}},flashPopup:function(){if(this.m_has_attention){if($(document.body).hasClassName("alert")){$(document.body).removeClassName("alert");}
else{$(document.body).addClassName("alert");}
setTimeout("ImUiManager.flashPopup('"+this.m_partner_screenname+"');",ImUiManager.m_window_flashing_rate)}},flashAttention:function(){if(this.m_has_attention&&!ImUiManager.m_is_a_popup){if($('im_wrapper_'+this.m_window_id).hasClassName("alert")){$('im_wrapper_'+this.m_window_id).removeClassName("alert");}
else{$('im_wrapper_'+this.m_window_id).addClassName("alert");}
setTimeout("ImUiManager.flashAttention('"+this.m_partner_screenname+"');",ImUiManager.m_window_flashing_rate)}},loseAttention:function(){this.m_has_attention=false;if(ImUiManager.m_is_a_popup){$(document.body).removeClassName('alert');}else{$('im_wrapper_'+this.m_window_id).removeClassName("alert");}},removeFocus:function(){if(!ImUiManager.m_is_a_popup){$('im_container_'+this.m_window_id).addClassName('unfocused');}},addFocus:function(){if(!ImUiManager.m_is_a_popup){ImUiManager.removeFocus();$('im_container_'+this.m_window_id).removeClassName('unfocused');}},draw:function(){var res="";var wrapper_style='';if(this.m_state=='expanded'){wrapper_style+=' expanded';}
else if(this.m_state=='collapsed'){wrapper_style+=' collapsed';}
else if(this.m_state=='hidden'||this.m_state=="popped"){wrapper_style+=' hidden';}
active_brand="";brand_ref="";brand_clickthru="";if(Branding.on&&HAS_ADFREE!="1"){for(var brand in Branding.campaigns){if(active_brand)
break;_brand=Branding.campaigns[brand];if(!_brand.on)
continue;triggerit=false;if(_brand.global)
triggerit=true;else if(typeof(METRO_AREA)!="undefined"&&METRO_AREA!="0"&&_brand.metrocode.indexOf(METRO_AREA)!=-1)
triggerit=true;else if(_brand.polygons){for(iter=0;iter<_brand.polygons.length;iter++){if(util.polygonBoundary(_brand.polygons[iter],[USER_LAT,USER_LON])){triggerit=true;break;}}}
if(triggerit){active_brand=_brand.classname;brand_ref=brand;if(_brand.clickthru)
brand_clickthru=_brand.clickthru;}}
if(this.m_state=="popped"&&$("p_popout_chat")){$("p_popout_chat").className=active_brand;}
this.pending_impression=true;}
branding_prepend='<div class="brand_shell '+active_brand+' '+brand_ref+'"><div class="utility1"></div><div class="utility2"></div>';branding_append='<div class="utility3"></div>';if(brand_clickthru)
branding_append+='<div class="utility4"><a target="_blank" href="'+brand_clickthru+'"></a></div></div>';else
branding_append+='<div class="utility4"></div></div>';var name_pass=this.m_partner_screenname;var key_pass={p_screenname:name_pass};if(!ImUiManager.m_is_a_popup){res+=''
+'<div class="im_container'+wrapper_style+'" id="im_container_'+this.m_window_id+'">'+branding_prepend
+' <div class="im_wrapper" id="im_wrapper_'+this.m_window_id+'">'
+'        <div class="im_tab">'
+'         <a href="#" class="im_option close" title="Close" onClick="ImUiManager.hideChat(\''+this.m_partner_screenname+'\'); return false;"></a>'
+'         <a href="#" class="im_option collapse" title="Minimize" onClick="ImUiManager.collapseChat(\''+this.m_partner_screenname+'\'); return false;" id="im_collapse_'+this.m_window_id+'"></a>'
+'         <a href="#" class="im_option expand" title="Expand" onClick="ImUiManager.expandChat(\''+this.m_partner_screenname+'\'); return false;" id="im_expand_'+this.m_window_id+'"></a>'
+'         <a href="#" class="im_option pop" title="Pop out conversation" onClick="ImUiManager.popChat(\''+this.m_partner_screenname+'\'); return false;" id="im_pop_'+this.m_window_id+'"></a>'
+'         <a href="#" class="im_option block" title="Block user" onClick="$(\'im_block_'+this.m_window_id+'\').toggle(); return false;"></a>'
+'   <span class="username">'+this.m_partner_screenname+'</span>'
+'     </div>'
+'  <div class="im_body" id="im_body_'+this.m_window_id+'">'
+'   <div class="im_block" id="im_block_'+this.m_window_id+'" style="display: none;">'
+'    <div class="im_block_wedge"></div>'
+'    <div class="im_block_buttons">'
+'     <a href="#" class="y" onClick="ImUiManager.doImBlock(\''+this.m_partner_screenname+'\'); return false;">Yes</a>'
+'     <a href="#" class="n" onClick="$(\'im_block_'+this.m_window_id+'\').toggle(); return false;">No</a>'
+'    </div>'
+'    <p>Ignore '+this.m_partner_screenname+'?</p>'
+'   </div>'
+'   <div class="im_text" id="im_expanded_contents_'+this.m_window_id+'"></div>'
+'   <div class="im_input">'
+'    <div class="input_wrapper">'
+'     <textarea name="message" value="" id="message_'+this.m_window_id+'"></textarea>'
+'    </div>'
+'   </div>'
+'  </div>'
+' </div>'
+branding_append+'</div>'}else{res+=branding_prepend
+'<div id="info_area">'
+' <a href="#" class="im_option pop" title="Put conversation back in window" onClick="ImUiManager.unpopAndChangeState(\''+this.m_partner_screenname+'\', \'expand\'); return false;" id="im_pop_'+this.m_window_id+'"></a>'
+' <a href="#" class="im_option block" title="Block user" onClick="$(\'block_area\').toggle(); return false;"></a>'
+'</div>'
+'<div id="block_area" style="display: none;">'
+' <div class="im_block_buttons">'
+'  <a href="#" class="y" onClick="ImUiManager.doImBlock(\''+this.m_partner_screenname+'\'); return false;">Yes</a>'
+'  <a href="#" class="n" onClick="$(\'block_area\').toggle(); return false;">No</a>'
+' </div>'
+' <p class="im_block_text">Ignore '+this.m_partner_screenname+'?</p>'
+'</div>'
+'<div class="im_text" id="im_expanded_contents_'+this.m_window_id+'"></div>'
+'<div class="send_area">'
+' <div class="input_wrapper">'
+'  <textarea name="message" value="" id="message_'+this.m_window_id+'"></textarea>'
+' </div>'
+'</div>'
+branding_append;}
if(ImUiManager.m_is_a_popup&&$('info_area'))return;Element.insert(this.m_destination_div,{"top":res});if(this.m_state=="expanded"){this.registerTakeoverImpression();}
$('message_'+this.m_window_id).observe("keyup",ImUiManager.catchKeyStroke.bindAsEventListener(ImUiManager,this.m_partner_screenname));$('message_'+this.m_window_id).observe("focus",ImUiManager.catchFocus.bindAsEventListener(ImUiManager,this.m_partner_screenname));$('message_'+this.m_window_id).observe("blur",ImUiManager.catchBlur.bindAsEventListener(ImUiManager,this.m_partner_screenname));if(!ImUiManager.m_is_a_popup){$('im_container_'+this.m_window_id).observe("click",ImUiManager.catchContainerClick.bindAsEventListener(ImUiManager,this.m_partner_screenname));$('im_container_'+this.m_window_id).addClassName('unfocused');}},updateBlockPane:function(html){$('im_block_'+this.m_window_id).down('div.im_block_buttons').hide();$('im_block_'+this.m_window_id).down('p').innerHTML=html;},getTypedMessage:function(){return $F('message_'+this.m_window_id);},clearTypedMessage:function(){$('message_'+this.m_window_id).value="";this.resizeInput();},setState:function(new_state){if(new_state=="collapsed")
this.collapse();else if(new_state=="expanded")
this.expand();},hide:function(){this.m_state='hidden';this.writeStateToCookie();ImUiManager.loseAttention(this.m_partner_screenname);this.removeFocus();if(!ImUiManager.m_is_a_popup)
$('im_container_'+this.m_window_id).removeClassName('expanded').removeClassName('collapsed').addClassName('hidden');else
ImUiManager.unpopAndChangeState(this.m_partner_screenname,'hide');},popChat:function(){this.m_state='popped';ImUiManager.loseAttention(this.m_partner_screenname);ImUiManager.removeFocus();if($('im_container_'+this.m_window_id))
$('im_container_'+this.m_window_id).removeClassName('expanded').removeClassName('collapsed').addClassName('hidden');},collapse:function(){if(this.m_state!="hidden"){ImUiManager.loseAttention(this.m_partner_screenname);}
this.m_state='collapsed';this.writeStateToCookie();this.removeFocus();if($('im_container_'+this.m_window_id))
$('im_container_'+this.m_window_id).removeClassName('expanded').removeClassName('hidden').addClassName('collapsed');},expand:function(){this.m_state='expanded';this.writeStateToCookie();ImUiManager.loseAttention(this.m_partner_screenname);if(!ImUiManager.m_is_a_popup){$('im_container_'+this.m_window_id).removeClassName('collapsed').removeClassName('hidden').addClassName('expanded');$('im_wrapper_'+this.m_window_id).focus();$('message_'+this.m_window_id).focus();}
this.registerTakeoverImpression();},unDraw:function(){alert("todo: undraw");},resizeInput:function(){if(ImUiManager.m_is_a_popup)return;var minheight=15,maxheight=minheight*2,box=$('message_'+this.m_window_id);var scrollheight=box.scrollHeight;var height=box.getHeight();if(scrollheight<minheight)scrollheight=minheight;if(scrollheight>maxheight)scrollheight=maxheight;if(box.value=='')scrollheight=minheight;box.setStyle({height:scrollheight+'px'});if(box.value.length>300){box.value=box.value.substring(0,300);}
box.scrollTop=100000000;},registerTakeoverImpression:function(){if(!$('im_container_'+this.m_window_id))return;if(!Branding||Branding.opened)return;var pixel='',randid=new Date().getTime();if($('im_container_'+this.m_window_id).firstDescendant().hasClassName('venus_smooth')){pixel='<IMG id="pixel_'+this.m_window_id+'" SRC="http://ad.doubleclick.net/ad/N5767.3376.MATCH.COM/B5923077.27;sz=1x1;pc=[TPAS_ID];ord=[timestamp]?" BORDER=0 WIDTH=1 HEIGHT=1 ALT="Advertisement" />';pixel+='<img src="http://amch.questionmarket.com/adsc/d938744/2/940538/adscout.php?ord=[timestamp]" height="1" width="1" border="0">';}
if(pixel!=''&&!$('pixel_'+this.m_window_id)){pixel=pixel.replace('[timestamp]',new Date().getTime());$('im_container_'+this.m_window_id).insert({bottom:pixel});setTimeout(this.sendStats.bindAsEventListener(this),500);}},sendStats:function(){if(!Branding.opened&&$('pixel_'+this.m_window_id)&&$('pixel_'+this.m_window_id).visible()){if(!Branding.opened_once){Branding.opened_once=true;util.updateStats('ads - venus smooth - im - opened once',1,'counter','DZpzVf+WE7toTSjaKKghe5sGtbY=');}
util.updateStats('ads - venus smooth - im - opened',1,'counter','szf/YWr1L9/W4DLCS1jWI734YiU=');}
Branding.opened=true;setTimeout(function(){Branding.opened=false;},1000);}});function IFrameInsertedAt(parentElement)
{var iframe=document.createElement("iframe");if(parentElement==null)
parentElement=document.body;parentElement.appendChild(iframe);iframe.doc=null;if(iframe.contentDocument)
iframe.doc=iframe.contentDocument;else if(iframe.contentWindow)
iframe.doc=iframe.contentWindow.document;else if(iframe.document)
iframe.doc=iframe.document;if(iframe.doc==null)
throw"Document not found, append the parent element to the DOM before creating the IFrame";iframe.doc.open();iframe.doc.close();return iframe;}
InstantEvents=new InstantEventsImplementation();ImUiManager=new ImUiManagerImplementation();EventUiManager=new EventUiManagerImplementation();Event.observe(window,"beforeunload",InstantEvents.endConnections.bindAsEventListener(InstantEvents));
			AUTOCORE_SELF_CHECK = null;
		
			// File : /okcontent/js/OkUploader.js
			AUTOCORE_SELF_CHECK = "/okcontent/js/OkUploader.js";
			
if(typeof Prototype=='undefined'||Prototype.Version<"1.6"){throw("OkUploader requires Prototype 1.6 or higher.");}
var OkUploaders=new Object();getSimpleUploader=function(dest_div_id,cb_function,extras){$(dest_div_id).innerHTML=""
+'<div id="'+dest_div_id+'-upload-success-region"></div>'
+'<div id="'+dest_div_id+'-upload-instructions"></div>'
+'<div id="'+dest_div_id+'-upload-region"></div>'
+'<div id="'+dest_div_id+'-uploader-access"></div>';return new OkUploader(dest_div_id+"-",cb_function,extras);};var OkUploader=Class.create({initialize:function(prefix,cb_function,extras){this.appname=prefix;this.maxwidth=500;this.minwidth=250;this.minheight=250;this.parsdata={};this.Prefix=prefix;this.ResultUrl="";this.Status="pending";this.CallBack=cb_function;this.Width="0";this.Height="0";this.From="";this.OriginalSource="";this.TempId=Math.round(Math.random()*100000000);this.Picid="0";if(extras){this.Extras=extras;}
else{this.Extras=new Object();}
this.Extras.Cropper=(this.Extras.Cropper&&!(Prototype.Browser.Opera&&navigator.appVersion.indexOf("Windows")!=-1))?true:false;Object.extend(this,this.Extras);OkUploaders[this.TempId]=this;this.startExperience();},getUploadUrl:function(){var params={temp_id:this.TempId,style_template:this.Extras.IFrameStyleTemplate,img_template:this.Extras.ImageTemplate,body_class:(this.Extras.BodyClass?this.Extras.BodyClass:''),facebook:(this.Extras.FacebookPhotoImporter?true:false),small:(this.Extras.Small?true:false),rand:(Math.random()*10000000000).round()}
if(this.Extras.ShouldCommit){params.commit='commit';params.status=this.Extras.CommitStatus;}
return'/ajaxuploader?'+Object.toQueryString(params);},startExperience:function(){var res='<div id="okupload-iframe-wrapper-'+this.TempId+'" class="okupload-iframe-wrapper">'
+'  <iframe frameborder="0" class="okupload-iframe" id="okupload-iframe-'+this.TempId+'" '
+this.Extras.IFrameParams+' >'
+'</iframe>'
+'<div id="okupload-iframe-loading" style="margin: 10px 0;"><em>Loading&hellip;</em></div>'
+'</div>';$(this.Prefix+'upload-region').innerHTML=res;$('okupload-iframe-'+this.TempId).src=this.getUploadUrl();$('okupload-iframe-'+this.TempId).hide();},iframeLoaded:function(){$('okupload-iframe-'+this.TempId).show();$('okupload-iframe-loading').remove();this.contentWindow=$('okupload-iframe-'+this.TempId).contentWindow;},selectFacebookPhoto:function(callback){this.Extras.FacebookPhotoImporter.promptForPhoto(callback);},facebookPhotoUploaded:function(){this.Extras.FacebookPhotoImporter.doneImporting();},doneUpload:function(res){if(!res.error){if(res.stripped_url)this.stripped_url=res.stripped_url;if(res.url)this.ResultUrl=res.url;if(res.from)this.From=res.from;if(res.original_source_url)this.OriginalSource=res.original_source_url;if(res.original_source_file)this.OriginalSource=res.original_source_file;if(res.width)this.Width=res.width;if(res.height)this.Height=res.height;if(res.type)this.Type=res.type;this.Status="success";if(res.id)this.Picid=res.id;if(res.facebook_photo){this.facebookPhotoUploaded();}
if(this.Extras.Cropper==true){this.crop();}else{this.done();}
if($('okupload-iframe-wrapper-'+this.TempId)){$('okupload-iframe-wrapper-'+this.TempId).innerHTML="";}}
else{this.Status="failure";this.done();}
this.onDoneUpload(res);},crop:function(){util.registerSuggestionActivity('upload_a_photo');this.factor=1;var pass=this;if(this.Width>this.maxwidth){this.factor=this.Width/this.maxwidth;}else if(this.Height<this.minheight){this.factor=this.Height/this.minheight;}else if(this.Width<this.minwidth){this.factor=this.Width/this.minwidth;}
show_width=Math.floor(this.Width/this.factor);show_height=Math.floor(this.Height/this.factor);var cropDisplayUrl="http://akcdn.okccdn.com/php/load_okc_image.php/images"
+"/"+show_width+"x"+show_height
+"/"+show_width+"x"+show_height
+"/0x0/0x0/0/"
+this.Picid
+"."
+this.getImgType(this.Type);this.cropregion=new Element('div',{'id':'cropregion'});this.image=new Element('img',{'id':'cropImage','src':cropDisplayUrl,'width':show_width,'height':show_height});this.cropregion.appendChild(this.image);$(this.Prefix+'upload-region').appendChild(this.cropregion);var action='';if(this.Extras.SendData)
action='javascript:dispatch('+pass.TempId+', "sendData", "'+this.Prefix+'");';else
action='javascript:dispatch('+pass.TempId+', "onEndCropper", "'+this.Prefix+'");';if($(this.Prefix+'upload-instructions')){if(typeof(Attacher)!='undefined'&&$(this.Prefix+'mature-options')){$(this.Prefix+'mature-options').show();}
this.finalsubber_p=new Element('p',{'class':'btn large_new_pic finished',onMouseOut:"util.toggleClass(this, 'hover')",onMouseOver:"util.toggleClass(this, 'hover')",onMouseUp:"util.toggleClass(this, 'active')",onMouseDown:"util.toggleClass(this, 'active')"});this.finalsubber=new Element('a',{'id':'submit-uploader','href':action});this.finalsubber.innerHTML="Finished!";this.finalsubber_p.appendChild(this.finalsubber);$(this.Prefix+'upload-instructions').appendChild(this.finalsubber_p);}
if($('upload_title')&&typeof(Attacher)!='undefined')
$('upload_title').update('Select a preview crop');else if($('upload_title'))
$('upload_title').update('Select yourself for the thumbnail image');if(this.CropStepFunction)this.CropStepFunction();var dmin=Math.min(this.Width,this.Height);var tn_x1=Math.floor((this.Width-dmin/2)/(2*this.factor));var tn_y1=Math.floor((this.Height-dmin/2)/(2*this.factor));var tnmin=Math.min(150/this.factor,Math.floor(dmin/this.factor));new Cropper.Img("cropImage",{onEndCrop:pass.onEnd,owner:pass,displayOnInit:1,minWidth:tnmin,minHeight:tnmin,ratioDim:{x:1,y:1},onloadCoords:{x1:tn_x1,y1:tn_y1,x2:Math.floor(tn_x1+(dmin/(2*pass.factor))),y2:Math.floor(tn_y1+(dmin/(2*pass.factor)))}});},onEnd:function(coords,dimensions){this.owner.cropinfo={tn_upper_left_x:Math.floor(coords.x1*this.owner.factor),tn_upper_left_y:Math.floor(coords.y1*this.owner.factor),tn_lower_right_x:Math.floor(coords.x2*this.owner.factor),tn_lower_right_y:Math.floor(coords.y2*this.owner.factor)};},onEndCropper:function(){this.done();},setVars:function(prefix){prefix=prefix?prefix:"";$(prefix+'upfile').value=this.OriginalSource;$(prefix+'picid').value=this.Picid;$(prefix+'imgtype').value=this.Type;$(prefix+'width').value=this.Width;$(prefix+'height').value=this.Height;$(prefix+'uploader-revision').value="$Revision: 163364 $";if(this.cropinfo){$(prefix+'tn_upper_left_x').value=this.cropinfo.tn_upper_left_x;$(prefix+'tn_upper_left_y').value=this.cropinfo.tn_upper_left_y;$(prefix+'tn_lower_right_x').value=this.cropinfo.tn_lower_right_x;$(prefix+'tn_lower_right_y').value=this.cropinfo.tn_lower_right_y;}},getImgType:function(type){switch(type){case 2:return"gif";case 3:return"png";default:return"jpeg";}},getPt:function(x,y){return x+'x'+y;},getThumb:function(min_box,max_box){var dbox={x:100,y:100};var mbox=min_box?min_box:dbox;var Mbox=max_box?max_box:mbox;return this.getPt(mbox.x,mbox.y)
+'/'+this.getPt(Mbox.x,Mbox.y)
+'/'+this.getPt(this.cropinfo.tn_upper_left_x,this.cropinfo.tn_upper_left_y)
+'/'+this.getPt(this.cropinfo.tn_lower_right_x,this.cropinfo.tn_lower_right_y)
+'/3/'+this.Picid
+'.'+this.getImgType(this.Type);},done:function(){this.CallBack(this);},onOfferUpload:function(){this.Extras.onOfferUpload?this.Extras.onOfferUpload():false;},onOfferImport:function(){this.Extras.onOfferImport?this.Extras.onOfferImport():false;},onDisplayUploading:function(){this.Extras.onDisplayUploading?this.Extras.onDisplayUploading():false;},onDoneUpload:function(res){this.Extras.onDoneUpload?this.Extras.onDoneUpload(res):false;}});function wrapFix(uploader_tempid){OkUploaders[uploader_tempid].done();}
function toggleMaturity(checkbox,prefix){if(!$('mature_description')||!$(prefix+'-maturity_check'))return;if(checkbox.checked){$('mature_description').show();$(prefix+'-maturity_check').value=1;}
else{$('mature_description').hide();$(prefix+'-maturity_check').value=0;}}
function dispatch(id,action,prefix){if(typeof(Attacher)!='undefined'&&$(prefix+'maturity_check')&&$F(prefix+'maturity_check')==1&&$('mature_description_text')&&$F('mature_description_text').length<=0){alert('Mature pictures must have descriptions');}
else{switch(action){case'sendData':OkUploaders[id].sendData();break;case'onEndCropper':OkUploaders[id].onEndCropper();break;}}}
var UploadManager={success_cb:null,failure_cb:null,after_crop_cb:null,okuploader:null,photo_params:{},uploader_params:{},showUploader:function(success_cb,failure_cb,after_crop_cb,uploader_params,photo_params){this.showBeaker();this.success_cb=success_cb;this.failure_cb=failure_cb;this.after_crop_cb=after_crop_cb;this.photo_params=photo_params||{};this.uploader_params=uploader_params||{};Object.extend(this.uploader_params,{IFrameStyleTemplate:'globals/shadowboxes.css',BodyClass:'single',Small:true,onOfferUpload:this.showUpload,onOfferImport:this.showImport,onDisplayUploading:this.showUploading,onDoneUpload:this.doneUploading});new Ajax.Request('/left_bar_uploader',{onSuccess:this.showUploader_cb.bindAsEventListener(this,this.uploader_params)});},showUploader_cb:function(transport,uploader_params){if($('uploader'))$('uploader').remove();$('main_content').insert({bottom:transport.responseText});this.resetUi();if(uploader_params&&uploader_params.FailureError){if(this.failure_cb)this.failure_cb(uploader_params.FailureError);}else{this.okuploader=getSimpleUploader('uploader_content',this.uploadCallback.bindAsEventListener(this,uploader_params),uploader_params);}
util.placeOnTop('uploader',1);this.hideBeaker();},showBeaker:function(){if($('uploader_beaker_outer')){$('uploader_beaker_outer').show();}else{$('main_content').insert({bottom:'<div id="uploader_beaker_outer"></div>'});}
if(document.viewport.getScrollOffsets().top>91){$('uploader_beaker_outer').setStyle({top:(document.viewport.getScrollOffsets().top)+'px'});}
else{$('uploader_beaker_outer').setStyle({top:'100px'});}
this.place('uploader_beaker_outer');},hideBeaker:function(){if($('uploader_beaker_outer'))Element.hide.delay(0.5,'uploader_beaker_outer');},resetUi:function(){util.hideProgress();if($('uploaded_thumb'))$('uploaded_thumb').remove();$('uploader').down('h3').update('Upload a photo: Step <span id="uploader_step">1</span> of 3');$('uploader_h4').update('Where is your photo?');$('uploader_content').update().show();$('uploader_buttons').hide().immediateDescendants().invoke('hide');$('uploader_next').show();$('uploader_startover_button').show();if(typeof ProfilePhotos!='undefined'&&ProfilePhotos.screenname!=null&&ProfilePhotos.current_album&&ProfilePhotos.current_album!=0)
$('uploader_sr_text').hide();else
$('uploader_sr_text').show();if(document.viewport.getScrollOffsets().top>91){$('uploader').setStyle({top:(document.viewport.getScrollOffsets().top)+'px'});}
else{$('uploader').setStyle({top:'100px'});}
if(this.uploader_params.startover_action){$('uploader_startover_button').down('a').writeAttribute('onclick',this.uploader_params.startover_action+'return false;');}
else{$('uploader_startover_button').down('a').writeAttribute('onclick','util.showUploader(); return false;');}
$('uploader').removeClassName('withpic').show();},showUpload:function(){UploadManager.process='upload';$('uploader_h4').update('Select the photo to upload');UploadManager.showImportOrUpload();},showImport:function(){UploadManager.process='import';$('uploader_h4').update('Enter the image URL below');UploadManager.showImportOrUpload();},showImportOrUpload:function(){if($('uploader_step'))$('uploader_step').update('2');if($('uploader_sr_text'))$('uploader_sr_text').hide();if($('uploader_buttons'))$('uploader_buttons').show();},processImage:function(){if(this.process=='upload'){this.okuploader.contentWindow.$('ajax_image_upload').click();}
else{this.okuploader.contentWindow.$('ajax_image_import').click();}},showUploading:function(){$('uploader_loader').show();},doneUploading:function(res){$('uploader_loader').hide();if(res.error&&!$('uploader')){$('uploader_h4').update('Error: '+res.error_text);$('uploader_content').hide();$('uploader_next').hide();}
else if(UploadManager.okuploader.Extras.Cropper&&!$('uploader_content').down('.oknotice_error')){if($('uploader_step'))$('uploader_step').update('3');$('uploader_h4').update('Select yourself for the thumbnail image');$('uploader_next','uploader_finished').invoke('toggle');}},finish:function(){dispatch(this.okuploader.TempId,'onEndCropper',this.okuploader.Prefix);},place:function(el){if(!$(el))return;var adjustment=(el=='uploader_beaker')?2:1;if(document.viewport.getScrollOffsets().top>91){$(el).setStyle({top:(document.viewport.getScrollOffsets().top)+'px'});}
else{$(el).setStyle({top:'100px'});}
util.placeOnTop(el,adjustment);},uploadCallback:function(okuploader,uploaderparams){$('uploader_content').update();if(uploaderparams&&uploaderparams.DontHide){$('uploader_h4').update('&nbsp;');$('uploader_buttons').hide();this.place('uploader');}
else $('uploader').hide();if(okuploader.Status=='success'&&okuploader.Extras.Cropper){if(UploadManager.after_crop_cb){UploadManager.after_crop_cb();}
var params={screenname:SCREENNAME,userid:CURRENTUSERID,use_new_upload:1,okc_api:1,upfile:okuploader.OriginalSource,picid:okuploader.Picid,imgtype:okuploader.Type,width:okuploader.Width,height:okuploader.Height,tn_upper_left_x:okuploader.cropinfo.tn_upper_left_x,tn_upper_left_y:okuploader.cropinfo.tn_upper_left_y,tn_lower_right_x:okuploader.cropinfo.tn_lower_right_x,tn_lower_right_y:okuploader.cropinfo.tn_lower_right_y}
Object.extend(params,UploadManager.photo_params);if(params.albumid&&params.albumid!='0')
params['picture.add_pic_album']=1;else{params['picture.add']=1;params['albumid']='';params['status']='';}
new Ajax.Request('/photoupload',{parameters:params,onSuccess:UploadManager.uploadSuccess.bindAsEventListener(this,okuploader),onFailure:UploadManager.uploadFailure.bindAsEventListener(this,okuploader)});}
else if(okuploader.Status=='success')
UploadManager.uploadSuccess(null,okuploader);else
UploadManager.uploadFailure(null,okuploader);},uploadSuccess:function(transport,okuploader){try{var response=transport.responseText.evalJSON();}catch(e){var response=false;}
if(UploadManager.success_cb)
UploadManager.success_cb(okuploader,response);},uploadFailure:function(transport,okuploader){if(UploadManager.failure_cb)
UploadManager.failure_cb(okuploader);}}
			AUTOCORE_SELF_CHECK = null;
		
			// File : /okcontent/js/Oryx/Feedback.js
			AUTOCORE_SELF_CHECK = "/okcontent/js/Oryx/Feedback.js";
			
var FeedbackImpl=Class.create({m_timeLoaded:{},initialize:function(){this.m_timeLoaded=new Date();},send:function(feedback_type,feedback_title,feedback_text,servergmt,additional_cgi){var params={};params["url"]=window.location.href;params["feedbacktype"]=feedback_type;params["feedbacktitle"]=feedback_title;params["feedbacktext"]=feedback_text;params["ajax"]=1;params["servergmt"]=servergmt;params["rand"]=Math.random();if(additional_cgi){for(var key in additional_cgi){params[key]=additional_cgi[key];}}
params["BrowserInfo"]=this.summarizeBrowserInfo(servergmt);new Ajax.Request("/feedback",{method:"post",parameters:params});},summarizeBrowserInfo:function(servergmt){var br=new Array(4);var os=new Array(2);var flash=new Array(2);br=getBrowser();os=getOS();flash=hasFlashPlugin();var client_info="\n----------------\n";client_info+="Time diff (at pageload): "+(this.m_timeLoaded.getTime()/1000-servergmt)+"seconds;\n Browser time: "+this.m_timeLoaded+" ("+this.m_timeLoaded.getTime()+") [Server = "+servergmt+"]\n";client_info+=("Browser identifier: "+br[0]+"\n");client_info+=("Browser version: "+br[1]+"\n");client_info+=("Browser major version: "+getMajorVersion(br[1])+"\n");client_info+=("Browser minor version: "+getMinorVersion(br[1])+"\n");client_info+=("Browser engine: "+br[2]+"\n");client_info+=("Browser engine version: "+br[3]+"\n");client_info+=("Full user agent string: "+getFullUAString()+"\n");client_info+=("Operating system identifier: "+os[0]+"\n");client_info+=("Operating system version: "+os[1]+"\n");client_info+=("Is Flash installed? "+(flash[0]==2?"Yes":(flash[0]==1?"No":"unknown"))+"\n");client_info+=("Flash version: "+flash[1]+"\n");client_info+=("Are popups allowed for this site? NOT TESTED.\n");client_info+=("JS? Yes, obviously.\n");return client_info;}});Feedback=new FeedbackImpl();
			AUTOCORE_SELF_CHECK = null;
		
			// File : /okcontent/js/Oryx/RejectManager.js
			AUTOCORE_SELF_CHECK = "/okcontent/js/Oryx/RejectManager.js";
			
var HiddenUsers={success:function(){},failure:function(){},params:{ajax:1,template:'reject/ajax_response.html'},hide:function(username,service,options){this.service=service;this.options=options;this.params.rejectee_username=username;this.params.btnreject=1;this.request();},show:function(username,service,options){this.service=service;this.options=options;this.params.rejectee_username=username;if(this.params.btnreject){delete this.params.btnreject;}
this.params.btndel=1;this.request();},request:function(){var params={parameters:this.params};if(this[this.service+'_success']){params.onSuccess=this[this.service+'_success'].bind(this);}
if(this[this.service+'_failure']){params.onFailure=this[this.service+'_failure'].bind(this);}
new Ajax.Request('/rejectmgr',params);},profile_success:function(){$('hide_btn').toggleClassName('unhider');$('unhide_btn').toggleClassName('unhider');},profile_failure:function(){},home_success:function(){activityFeedFilter.hideAllStories(this.params.rejectee_username);},home_failure:function(){},home_stalker_hide_success:function(){HomeVisitors.hideVisitor(this.params.rejectee_username);},home_stalker_hide_failure:function(){},home_stalker_show_success:function(){HomeVisitors.showVisitor(this.params.rejectee_username);},home_stalker_show_failure:function(){},match_success:function(){$('hide_btn_'+this.options.row).toggleClassName('unhider');$('unhide_btn_'+this.options.row).toggleClassName('unhider');},match_failure:function(){},hiddenusers_success:function(){$('dead_'+this.options.row).remove();$('rejectee_username').update('<a href="/profile/'+this.params.rejectee_username+'" ><strong>'+this.params.rejectee_username+'</strong></a>');$('unhide_successful').style.display="block";if($('cgi_msg').length!==0){$('cgi_msg').hide();}},hiddenusers_failure:function(){}};
			AUTOCORE_SELF_CHECK = null;
		
			// File : /okcontent/js/photobrowser/photobrowser.js
			AUTOCORE_SELF_CHECK = "/okcontent/js/photobrowser/photobrowser.js";
			
var ScrollInput=Class.create({initialize:function(element,options){this.element=$(element);this.options=options||{};this.onStart=options.onStart||Prototype.emptyFunction;this.onScroll=options.onScroll||Prototype.emptyFunction;this.onEnd=options.onEnd||Prototype.emptyFunction;this.scrolling=false;this.startingPos=null;if(Prototype.Browser.MobileSafari){this.element.observe('touchstart',this.eventScrollStart.bindAsEventListener(this));document.observe('touchmove',this.eventPointerMove.bindAsEventListener(this));document.observe('touchend',this.eventScrollEnd.bindAsEventListener(this));document.observe('touchcancel',this.eventScrollEnd.bindAsEventListener(this));}else{this.element.observe('mousedown',this.eventScrollStart.bindAsEventListener(this));document.observe('mousemove',this.eventPointerMove.bindAsEventListener(this));document.observe('mouseup',this.eventScrollEnd.bindAsEventListener(this));}},eventScrollStart:function(event){this.scrolling=true;document.observe('selectstart',this.selectCatcher);this.startingPoint=this.pointFromEvent(event);this.lastPoint=this.startingPoint;this.onStart(event);},eventPointerMove:function(event){if(this.scrolling){var point=this.pointFromEvent(event);event.pointerX=point.x;event.pointerY=point.y;event.scrollDelta={x:point.x-this.lastPoint.x,y:point.y-this.lastPoint.y}
this.onScroll(event);this.lastPoint=point;}},eventScrollEnd:function(event){this.scrolling=false;document.stopObserving('selectstart',this.selectCatcher);this.onEnd(event);},pointFromEvent:function(event){if(event.touches){return{x:event.touches[0].pageX,y:event.touches[0].pageY}}else{return{x:event.pageX,y:event.pageY}}},selectCatcher:function(event){event.stop();}})
var Scrollbar=Class.create({initialize:function(handle,track,options){this.handle=$(handle);this.track=$(track);this.options=options||{};this.handle.hide();this.rangeVisibility=this.options.rangeVisibility;this.range=this.options.range||$R(0,1);this.value=0;this.onSlide=this.options.onSlide||Prototype.emptyFunction;this.onChange=this.options.onChange||Prototype.emptyFunction;this.lastPointerPos=null;this.dragging=false;this.refresh();this.input=new ScrollInput(this.handle,{onStart:this.eventInputStart.bindAsEventListener(this),onScroll:this.eventInputMove.bindAsEventListener(this),onEnd:this.eventInputEnd.bindAsEventListener(this)})},refresh:function(){this.minimum=this.range.start;this.maximum=this.range.end;if(this.rangeVisibility){if(this.maximum>0){this.handle.style.width=((this.rangeVisibility/(this.rangeVisibility+this.maximum))*100)+'%';if(this.handle.visible&&!this.handle.visible()&&this.handle.appear){this.handle.appear({duration:0.5});}else{this.handle.style.display='block';}}else{this.handle.style.display='none';}}else{this.handle.style.width='100%'}
this.handleOffset=0;this.handleLength=this.handle.getWidth();this.trackLength=this.track.getWidth();this.handleOffsetMax=this.trackLength-this.handleLength;this.handleOffsetMin=0;},setValue:function(value){if(value>this.maximum){value=this.maximum;}else if(value<this.minimum){value=this.minimum;}
this.value=value;this._setHandleOffset(value/this.maximum*this.handleOffsetMax);this.onSlide(this.value);},eventInputStart:function(event){this.handle.addClassName('held');this.trackCumulativeLeft=this.track.cumulativeOffset().left;this.trackCumulativeRight=this.trackCumulativeLeft+this.trackLength;event.stop();},eventInputMove:function(event){if(event.pointerX>this.trackCumulativeLeft&&event.pointerX<this.trackCumulativeRight){var newPct=(this.handleOffset+event.scrollDelta.x)/this.handleOffsetMax;this.setValue(newPct*this.maximum);}},eventInputEnd:function(event){this.handle.removeClassName('held');},_setHandleOffset:function(offset){if(offset>this.handleOffsetMax){offset=this.handleOffsetMax;}else if(offset<this.handleOffsetMin){offset=this.handleOffsetMin;}
this.handleOffset=offset;if(navigator.userAgent.include('iPad')){this.handle.style.webkitTransform="translate3d("+this.handleOffset+"px, 0, 0)";}else{this.handle.style.left=this.handleOffset+"px";}},_eventStopper:function(event){event.stop();}})
var ThumbnailScrollbar=new Class.create({initialize:function(element,options){this.element=$(element);this.listItems=this.element.select('li');this.options=options||{};this.onSelect=options.onSelect||Prototype.emptyFunction;this.onSelectStart=options.onSelectStart||Prototype.emptyFunction;this.onSelectEnd=options.onSelectEnd||Prototype.emptyFunction;this.scrolling=false;this.scrollEndingTimeout=null;this.lastPhotoIndex=null;if(Prototype.Browser.MobileSafari){this.positionMap=new Array();this.listItems.each(function(item){this.positionMap.push(item.cumulativeOffset().left);}.bind(this));this.touchInput=new ScrollInput(this.element,{onScroll:this.eventTouchScroll.bindAsEventListener(this),onStart:this.onSelectStart.bind(this),onEnd:this.onSelectEnd.bind(this)})
this.listItems.each(function(item,index){item.observe('touchstart',this.select.bindAsEventListener(this,index));}.bind(this));}else{this.element.observe('mouseover',this.eventListMouseOver.bindAsEventListener(this));this.element.observe('mouseout',this.eventListMouseOut.bindAsEventListener(this));this.listItems.each(function(item,index){item.observe('mouseover',this.select.bindAsEventListener(this,index));}.bind(this))}},eventTouchScroll:function(event){var pointerX=event.touches[0].pageX;this.positionMap.each(function(pos,index){if(pointerX>=pos&&(pointerX<this.positionMap[index+1]||index+1==this.positionMap.length)){this.select(event,index);return $break;}}.bind(this));},eventListMouseOver:function(event){if(this.scrollEndingTimeout){clearTimeout(this.scrollEndingTimeout);this.scrollEndingTimeout=null;}else{this.eventSelectStart();}},eventListMouseOut:function(event){this.scrollEndingTimeout=setTimeout(this.eventSelectEnd.bind(this),150);},eventSelectStart:function(){this.onSelectStart();},eventSelectEnd:function(){this.scrollEndingTimeout=null;this.onSelectEnd();},select:function(event,index){if(this.lastPhotoIndex!=index){this.lastPhotoIndex=index;this.onSelect(index,event);}}})
var PhotoBrowser=Class.create({initialize:function(el,options){this.element=$(el);this.options=options||{};this.listEl=this.element.down('ul');this.items=this.listEl.select('li.item');this.currentOffset=0;this.itemSeparation=this.options.itemSeparation||6;this.itemsCount=this.items.length;this.queuedAnimation=null;this.scrollbarTrack=this.element.down('.scrollbar');this.scrollbarHandle=this.scrollbarTrack.down('.hitspot');this.items.each(function(item){if(item.down('img')){item.down('img').observe('load',this.imageLoaded.bind(this));}}.bind(this));this.scrollbar=new Scrollbar(this.scrollbarHandle,this.scrollbarTrack,{onSlide:this.eventScrollbarSlide.bind(this)});if(Prototype.Browser.MobileSafari){this.listScrollInput=new ScrollInput(this.listEl,{onScroll:this.eventListScroll.bindAsEventListener(this)});}
if(this.options.thumbnails!==false){this.thumbListEl=this.element.down('ul.thumbnails');this.thumbListItemEls=this.thumbListEl.select('li');this.thumbListEl.style.width=30*this.itemsCount;this.thumbScroller=new ThumbnailScrollbar(this.thumbListEl,{onSelect:this.eventItemSelect.bind(this),onSelectStart:function(){this.listEl.addClassName('thumbnail_scrolling');}.bind(this),onSelectEnd:function(){this.listEl.removeClassName('thumbnail_scrolling');}.bind(this)});}
this.refresh();},refresh:function(){this.frameWidth=this.options.frame_width||726;this.itemsWidth=this.getListWidth();var rangeEnd=this.itemsWidth<this.frameWidth?0:this.itemsWidth-this.frameWidth;this.scrollbar.range=$R(0,rangeEnd);this.scrollbar.rangeVisibility=this.frameWidth;this.scrollbar.refresh();},getListWidth:function(){var width=0;this.items.each(function(item){var separation=item!=this.items.last()?this.itemSeparation:0;item.style.marginRight=separation+"px";width+=item.getWidth()+separation;}.bind(this));return width;},imageLoaded:function(event){this.refresh();},eventListScroll:function(event){this.scrollbar.setValue(this.scrollbar.value-event.scrollDelta.x);},eventItemSelect:function(index){this.scrollToIndex(index);},eventScrollbarSlide:function(value,event){this.scrollTo(Math.round(value));},scrollToIndex:function(index){var item=this.items[index];var centeredOffset=item.offsetLeft-((this.frameWidth-item.getWidth())/2);this.scrollbar.setValue(centeredOffset)},scrollTo:function(offset){var startEdge=0;var endEdge=this.scrollbar.range.end;this.setLeftOffset(offset,false);},setLeftOffset:function(offset,animate){var newLeft=-offset;if(navigator.userAgent.include('iPad')){this.listEl.style.webkitTransform="translate3d("+newLeft+"px, 0, 0)";}else{if(this.listEl.hasClassName('thumbnail_scrolling')){if(this.queuedAnimation)clearTimeout(this.queuedAnimation);this.queuedAnimation=setTimeout(function(){new Effect.Morph(this.listEl,{style:'left: '+newLeft+'px',duration:0.3});}.bind(this),150);}else{this.listEl.style.left=newLeft+'px';}}
this.currentOffset=newLeft;}});
			AUTOCORE_SELF_CHECK = null;
		
			// File : /okcontent/js/service/home.js
			AUTOCORE_SELF_CHECK = "/okcontent/js/service/home.js";
			
var Home={poke:[],initialize:function(user_data){this.poke.each(function(p){var event_data=Object.extend(p,user_data);DC.recordPoke(event_data);});},matchesBrowser:null,nextmatches:null,checktimeout:null,duration:0.4,timeoutduration:10,matchesreloaded:false,transition:{off:'Fade',on:'Appear'},cycle:function(){if(!$('matches_block'))return;delete this.nextmatches;if(!this.matchesreloaded){this.matchesreloaded=true;util.updateStats('home - matches refreshed - per pageload',1,'counter','N8M/btuDklcEgKKHFXtUiLBql/w=');}
util.updateStats('home - matches refreshed - total',1,'counter','xm+cn5EKiAG8P1+IPsvJRsPKwMA=');$('matchphotobrowser_loading').show();clearTimeout(this.checktimeout);this.checktimeout=setTimeout(this.check.bind(this),this.timeoutduration*1000);new Ajax.Request('/home',{parameters:{matchesonly:1},onSuccess:this.cycle_cb.bind(this)});},cycle_cb:function(transport){this.nextmatches=transport.responseText;clearTimeout(this.checktimeout);if(this.nextmatches.replace(/\s/gi,'')==''){delete this.nextmatches;this.check(true);return;}
$('matches_block').addClassName('updating');$('matchphotobrowser').addClassName('refreshed');new Effect[this.transition.off]('matchphotobrowser',{duration:Home.duration,afterFinish:this.show.bind(this)});},show:function(){if(!$('matchphotobrowser'))return;$('matchphotobrowser').hide().update(this.nextmatches);$('matchphotobrowser_loading').fade({duration:0.3});$('matchphotobrowser').addClassName('refreshed');new Effect[this.transition.on]('matchphotobrowser',{duration:this.duration,afterFinish:this.re_init.bind(this)});},check:function(nomatches){if(nomatches){util.updateStats('home - matches refreshed - no matches found',1,'counter','P/cNV0N5+M7jqHtHjU8+kFiabU8=');}else{util.updateStats('home - matches refreshed - timeout',1,'counter','jvp+uF/1tLf0zJQgPgItOdsdxMo=');}
if(!this.nextmatches){$('matchphotobrowser_loader').hide();$('matchphotobrowser_timeout').show();setTimeout(function(){$('matchphotobrowser_loading').fade({duration:0.7,afterFinish:function(){$('matchphotobrowser_loader').show();$('matchphotobrowser_timeout').hide();}});},1700);}},re_init:function(){this.matchesBrowser=new PhotoBrowser('matches_block');$('matches_block').removeClassName('updating');setTimeout('util.reloadAds();',500);},skip:function(qid){new Ajax.Request('/questions/ask',{parameters:{ajax:1,qid:qid,skip:1},onSuccess:this.skip_cb.bind(this)});},skip_cb:function(){location.href='/questions';}};var EventFeed={talkAboutIt:function(whom,type,content){switch(type){case"STALK_EVENT":subject="I saw you viewed my profile ...";break;case"FORUM_COMMENT":case"FORUM_POST":subject="I saw that you posted in the forums ...";break;case"TEST_TAKEN":subject="I saw you took a test ...";break;case"PSYCHGAME_TAKE":subject="I saw you played the Psychologist Game ...";break;case"JOURNAL_POST":subject="I saw you posted in your journal ...";break;case"BOARD_COMMENT":subject="I saw you posted a comment ...";break;case"NTH_QUESTION":subject="I saw you answered a question ...";break;case"GOING_PUBLIC":subject="I saw you made a question public ...";break;case"Q_NOTE":subject="I saw you explained a question you answered ...";break;case"PROFILE_UPDATED":subject="I saw you updated your profile ...";break;case"DISPLAY_STATUS_CHANGE":subject="I saw you changed your status ...";break;case"SHOP_PURCHASE":subject="I saw you made a shop purchase ...";break;case"USER_UPGRADED_SELF":subject="I saw you upgraded to A-List ...";break;case"USER_UPGRADED_RECEIVED":subject="I saw you received an A-List upgrade ...";break;case"USER_UPGRADED_BUY":subject="I saw you bought someone an A-List plan ...";break;case"TOOLBAR_INSTALLED":subject="I saw you installed the OkCupid toolbar ...";break;default:subject="I saw you on my event feed ...";}
var mailForm=document.createElement("form"),_compose=document.createElement("input"),_subject=document.createElement("input"),_whom=document.createElement("input"),_body=document.createElement("input"),_tracker=document.createElement("input");mailForm.method="post";mailForm.action="/mailbox";mailForm.appendChild(_subject);mailForm.appendChild(_compose);mailForm.appendChild(_whom);mailForm.appendChild(_body);mailForm.appendChild(_tracker);_compose.name="compose";_compose.value="1";_body.name="body_text_encoded";_body.value=content;_subject.name="subject";_subject.value=subject;_whom.name="r1";_whom.value=whom;_tracker.name="eventfeed";_tracker.value="1";document.body.appendChild(mailForm);mailForm.submit();}}
var HomeBrowser={hideUser:function(username){if($('browser_'+username)&&$('browser_'+username).visible()){$('browseractive_'+username).hide();$('browserthumb_'+username).down('img').setStyle({opacity:0.1});var undo='<div id="browserundo_username">That member is now hidden. ';undo+='<a href="#" onclick="HiddenUsers.show(\'username\', \'home/reject_result.html\', HomeBrowser.showUser(\'username\') ); return false;">Undo this</a>.';undo+='</div>';undo=undo.replace(/username/gi,username);$('browseractive_'+username).insert({after:undo});$('browser_'+username).addClassName('undo');}},showUser:function(username){if($('browserundo_'+username)&&$('browser_'+username)){$('browserundo_'+username).remove();$('browseractive_'+username).show();$('browserthumb_'+username).down('img').setStyle({opacity:1.0});$('browser_'+username).removeClassName('undo');}},toggleHide:function(username,action){if(action=='show'){$('browserhover_'+username).show();$('browserdetails_'+username).hide();}else{$('browserhover_'+username).hide();$('browserdetails_'+username).show();}}};var HomeVisitors={hideVisitor:function(username){if($('visitor_'+username)&&$('visitor_'+username).visible()){$('visitor_'+username).hide();var undo='<li class="undo" id="visitorundo_username">That member is now hidden. ';undo+='<a href="#" onclick="HiddenUsers.show(\'username\', \'home_stalker_show\', null ); return false;">Undo this</a>.';undo+='</li>';undo=undo.replace(/username/gi,username);$('visitor_'+username).insert({after:undo});}},showVisitor:function(username){if($('visitorundo_'+username)&&$('visitor_'+username)){$('visitorundo_'+username).remove();$('visitor_'+username).show();}},toggleHide:function(username,action){if(action=='show'){$('visitorhide_'+username).show();}else{$('visitorhide_'+username).hide();}}};function flagPicture(pic_id){if($('flag_comment_'+pic_id).value==""){alert('You must enter a comment to report a picture.');$('flag_comment_'+pic_id).focus();return;}
var fl=$('flag_link_'+pic_id);var fb=$('flag_button_'+pic_id);new Ajax.Request('/flagmod',{parameters:$('flag_'+pic_id).serialize(),onCreate:function(){$('pic_'+pic_id+'_flagged').innerHTML='1';fb.innerHTML='<p class="flagging"><img src="http://akcdn.okccdn.com/media/img/misc/preload_666_transparent_16.gif" style="margin-right: 5px;" alt="Spinning preload image" /> Reporting ...</p>';},onSuccess:function(){fl.replace("Reported");util.toggle('flag_'+pic_id);},onFailure:function(){fb.innerHTML='<p style="color:#666">Whoops!  We had an issue.  Try again later. <a href="javascript:util.toggle(\'flag_'+pic_id+'\');">Close</a></p>';}});}
function showFlagForm(pic_id,user_id){var flag_container=$$('#pic_container_'+pic_id+' .flag_form_holder')[0];var flag_form='<form action="#" method="post" id="flag_'+pic_id+'" class="clearfix">'
+'<p><label for="flag_comment_'+pic_id+'">How does this picture violate our <a href="/legal/terms">terms of service?</a></label></p>'
+'<p><input name="comment" id="flag_comment_'+pic_id+'" /></p>'
+'<p class="hidden">'
+'  <input type="hidden" value="'+user_id+'" name="owner_id"/>'
+'  <input type="hidden" value="'+pic_id+'" name="object_id"/>'
+'  <input type="hidden" value="0" name="type"/>'
+'  <input type="hidden" value="1" name="doFlag"/>'
+'  <input type="hidden" value="1" name="AJAX"/>'
+'</p>'
+'<div id="flag_button_'+pic_id+'">'
+'<p id="" class="btn small green" onmouseout="util.removeClassName(this, \'hover\')" onmouseover="util.addClassName(this, \'hover\')" onmouseup="util.removeClassName(this, \'active\')" onmousedown="util.addClassName(this, \'active\')" style="">'
+'<a id="" class="" onclick="javascript:flagPicture(\''+pic_id+'\'); return false;" href="#">Report</a>'
+'</p>'
+'<p id="" class="btn small white" onmouseout="util.removeClassName(this, \'hover\')" onmouseover="util.addClassName(this, \'hover\')" onmouseup="util.removeClassName(this, \'active\')" onmousedown="util.addClassName(this, \'active\')" style="">'
+'<a id="" class="" onclick="$(\'flag_'+pic_id+'\').remove(); return false;" href="#">Cancel</a>'
+'</p>'
+'</div>'
+'</form>';flag_container.innerHTML="";if($('pic_'+pic_id+'_flagged')&&$('pic_'+pic_id+'_flagged').innerHTML=='1'){flag_container.innerHTML='<p class="error" style="margin:10px 0;clear:both;">You already reported this picture! <a style="color:#fff;font-weight:bold;" href="#close" onclick="$(this.parentNode).remove(); return false;">Close</a></p>';}
else if($('flag_'+pic_id)){$('flag_'+pic_id).remove();}
else{flag_container.innerHTML=flag_form;$('flag_comment_'+pic_id).focus();}}
var ActivityFeedFilter=Class.create({filterEvents:new Hash({all:[],stalkers:["STALK_EVENT"],photos:["PICTURE_UPLOAD"],comments:["FORUM_POST","FORUM_COMMENT"],tests:["TEST_TAKEN","PSYCHGAME_TAKE"],journals:["JOURNAL_POST","BOARD_COMMENT"],questions:["GOING_PUBLIC","Q_NOTE"],forums:["FORUM_POST","FORUM_COMMENT"],profiles:["PROFILE_UPDATED","TOOLBAR_INSTALLED","DISPLAY_STATUS_CHANGE","SHOP_PURCHASE","USER_UPGRADED_BUY","USER_UPGRADED_SELF","USER_UPGRADED_RECEIVED"]}),hideAllStories:function(username){var stories=$('recent_activity').childElements();var itemcount=0;for(var i=0;i<stories.length;i++){if(stories[i].hasClassName(username)){stories[i].hide();}
if(stories[i].style.display=='none'){itemcount++;}}
if(itemcount==stories.length){$('recent_activity').innerHTML='<li class="noresults">Nothing to see here&hellip;</li>';}}});
			AUTOCORE_SELF_CHECK = null;
		
addNewCoresToCookie(["2", "8", "10", "12", "21", "30", "31", "42", "47", "51", "57", "84"], "44f0be9a");